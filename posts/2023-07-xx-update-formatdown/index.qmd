---
title: "formatdown v0.1.2"
description: |
    Adding functionality to formatting tools for numerical quantities in vectors or data frames when creating documents in rmarkdown or quarto markdown 
date: "July 9, 2023"
date-format: "YYYY--MM--DD"
categories: [R, engineering notation, scientific notation, units, rmarkdown, quarto]
image: "thumbnail.png"
cap-location: margin
draft: true
---

```{r}
#| label: setup
#| include: false
#| tbl-cap-location: top

# knitr working directory -> project level
knitr::opts_knit$set(root.dir = rprojroot::find_rstudio_root_file())

# printing options for data.table
options(
  datatable.print.nrows = 10,
  datatable.print.topn = 5,
  datatable.print.class = TRUE
)

```

:::{.callout-note}
## Summary 
<em>Add functionality to improve usability by addressing issues raised during testing. New arguments in the powers-of-ten function for math delimiters and fixed exponents. New functions to format decimal and integer values and to interact with the units package.</em>
:::

Having successfully submitted the formatdown package to CRAN in November, 2022, I wrote a [post](https://graphdr.github.io/data-stories/posts/2022-11-18-formatdown/) to introduce the package and immediately uncovered several issues that had not appeared while working on the package vignettes. Those issues have been addressed and the latest release includes: 

- New arguments `delim` and `set_power` in `format_power()`.
- New function `format_decimal()` and vignette.
- New function `format_units()` and vignette.
- New data sets `atmos`, `metals`, `water`, and `air_meas`.


```{r}
library(formatdown)
library(data.table)
library(knitr)
library(kableExtra)
```

## Delimiters

A described in the original [post](https://graphdr.github.io/data-stories/posts/2022-11-18-formatdown/#delimiter-issue), `format_power()` rendered from a quarto document (as in this blog) failed when using `knitr::kable()` and `kableExtra::kbl()` even though they rendered correctly in the package vignette output. 

```{r}
DT <- copy(air_meas)
DT$pres <- format_power(DT$pres, 4)

DT

kableExtra::kbl(DT, align = "r")

knitr::kable(DT, align = "r")
```


The new `delim` argument in `format_power()` enables an author to change  delimiters from the default  `$ ... $` delimiters to `\\( ... \\)`. The argument is a character vector (length 1 or 2) defining the delimiters for marking up inline math. Possible values include "`$`" or "`\\(`", both of which create appropriate left and right delimiters. Alternatively, left and right can be defined explicitly in a character vector of length two, e.g., `c("$", "$")` or `c("\\(", "\\)")`. Custom delimiters can be assigned to suit the markup environment. 

```{r}
DT <- copy(air_meas)
DT$pres <- format_power(DT$pres, 4, delim = "\\(")

DT

kableExtra::kbl(DT, align = "r")

knitr::kable(DT, align = "r")
```




### Additional software credits {.appendix}

- [`checkmate`](https://mllg.github.io/checkmate/) for internal function argument checks 
- [`wrapr`](https://winvector.github.io/wrapr/) for internal function authoring tools
- [`units`](https://r-quantities.github.io/units/) for managing units of  physical quantities 

