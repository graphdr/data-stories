{
  "hash": "71f813689779e01366429c65597acd75",
  "result": {
    "markdown": "---\ntitle: \"Introducing formatdown\"\ndescription: |\n    Provides powers-of-ten formatting for a numerical vector or data frame column when creating documents in rmarkdown or quarto markdown. \ndate: \"November 21, 2022\"\ndate-format: \"YYYY--MM--DD\"\ncategories: [R, engineering notation, scientific notation, units, rmarkdown, quarto]\nimage: \"thumbnail.png\"\ncap-location: margin\ndraft: false\n---\n\n\n\n\n:::{.callout-note}\n## Summary \n<em>Convert the elements of a numerical vector or data frame column to character strings in which the numbers are formatted using powers-of-ten notation in scientific or engineering form and delimited for rendering as inline equations in an rmarkdown document.</em>\n:::\n\nInitial release of the  [`formatdown`](https://CRAN.R-project.org/package=formatdown) R package providing tools for formatting output in `rmarkdown` or `quarto` markdown documents. \n\nThis first version has one function only, `format_power()`, for converting numbers to character strings formatted in powers-of-ten notation and delimited in `$...$` for rendering as inline equations in `.Rmd` or `.qmd` output documents. Provides two powers-of-ten formatting options---scientific notation and engineering notation---with an option to omit powers-of-ten notation for a specified range of exponents. \n\nTo illustrate the different formats, I show in @tbl-examples the same number rendered using different formats, all with 4 significant digits.  \n\nThe R code for the post is listed under the “R code” pointers. In the examples, I use `data.table` syntax for data manipulation, though the code can be translated into `base R` or `dplyr` syntax if desired. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"formatdown\")\nlibrary(\"data.table\")\n\nx <- 4.567E-4                                   # value\nx1 <- format_power(x, 4, omit_power = c(-6, 0)) # omit power-of-ten\nx2 <- format_power(x, 4, format = \"sci\")        # scientific\nx3 <- format_power(x, 4)                        # engineering\n\n# render in markdown table below\n```\n:::\n\n\n| Notation       | Name   | Value                  | Rendered as |\n|:---------------|:------:|:----------------------------|-------:|  \n| without $10^n$ |  `x1`  | `\"$0.0004567$\"`             | \\(0.0004567\\) |\n| scientific     |  `x2`  | `\"$4.567\\\\times{10}^{-4}$\"` | \\(4.567\\times{10}^{-4}\\) | \n| engineering    |  `x3`  | `\"$456.7\\\\times{10}^{-6}$\"` | \\(456.7\\times{10}^{-6}\\) |\n\n: Rendering a number using different formats {#tbl-examples}{tbl-colwidths=\"[20,20,30,30]\"}\n\n\n\n\n\n\n## Background \n\nMy first attempt to provide powers-of-ten formatting was in my 2016 package, [`docxtools`](https://CRAN.R-project.org/package=docxtools). That implementation has several shortcomings.  \n\nI wrote its formatting function to accept a data frame as input, which entailed a lot of programming overhead to separate numerical from non-numerical variable classes and to reassemble them after the numerical columns were formatted. This could have been simplified with judicious use of `lapply()`, with which I was not sufficiently experienced at the time. I also failed to take advantage of `formatC()` in constructing the output. \n\nWith `formatdown`, my goal is to provide similar functionality but with more concise code, greater flexibility, and a more balanced approach to package dependencies. \n\n\n\n\n\n\n## Improvements\n\nThe primary design change is that the `format_power()` function operates on a numerical *vector* instead of a *data frame*. The benefits of this change are: 1) simpler code that should be easier to revise and maintain; 2) scalar values can be formatted for rendering inline; and 3) data frames can still be formatted, by column, using `lapply()`. \n\nTo illustrate formatting a scalar value inline, the markup for Avogadro's number (`x = 6.0221E+23`) in engineering format is given by,  \n\n\n\n````markdown\n    $N_A =$ `r format_power(x, digits = 5, format = \"engr\")`\n````\n\n\nwhich is rendered (in this output document) as $N_A =$ \\(602.21\\times{10}^{21}\\). \n\nThe second improvement is the addition of an option for scientific notation. For example, the markup for Avogadro's number in scientific notation  is given by, \n\n\n\n````markdown\n    $N_A =$ `r format_power(x, digits = 5, format = \"sci\")`\n````\n\n\nwhich renders as $N_A =$ \\(6.0221\\times{10}^{23}\\). \n\nThe third improvement is the addition of an option for omitting powers-of-ten notation over a range of exponents. For example, the markup for `x = 1.23E-4` in decimal notation is given by, \n\n\n\n````markdown\n    $x =$ `r format_power(x = 1.234E-4, omit_power = c(-4, 0))`\n````\n\n\nwhich renders as $x =$ \\(0.000123\\). \n\nA final (internal) improvement is a more balanced approach to package dependencies. With a tighter focus on what `formatdown` is to accomplish compared to `docxtools`, I have reduced the dependencies to `checkmate`,  `wrapr`, and `data.table`. \n\nThe package [vignette](https://graphdr.github.io/formatdown/articles/) illustrates package usage in detail. \n\nHowever, having successfully submitted the package to CRAN, I started working on this post and immediately (!) uncovered an issue that had not appeared while working on the package vignettes. \n\n\n\n\n\n## Delimiter issue\n\nI wrote the package vignette using the `rmarkdown::html_vignette` output style per usual. All the formatted output rendered as expected in that document. I write this blog using [quarto](https://quarto.org/docs/websites/website-blog.html). As seen in the examples above, inline math is rendered as expected. \n\nThe issue arises when using `knitr::kable()` and `kableExtra::kbl()` to display data tables in this blog post. To illustrate, consider this data frame, included with `formatdown` (ideal gas properties of air at room temperature). \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndensity\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date  trial humidity    T_K   p_Pa     R  density\n       <Date> <char>   <fctr>  <num>  <num> <int>    <num>\n1: 2018-06-12      a      low 294.05 101100   287 1.197976\n2: 2018-06-13      b     high 294.15 101000   287 1.196384\n3: 2018-06-14      c   medium 294.65 101100   287 1.195536\n4: 2018-06-15      d      low 293.35 101000   287 1.199647\n5: 2018-06-16      e     high 293.85 101100   287 1.198791\n```\n:::\n:::\n\n\nFormatting the pressure column, the markup looks OK. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT <- copy(density)\nDT$p_Pa <- format_power(DT$p_Pa, 4)\nDT\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date  trial humidity    T_K                       p_Pa     R  density\n       <Date> <char>   <fctr>  <num>                     <char> <int>    <num>\n1: 2018-06-12      a      low 294.05 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.197976\n2: 2018-06-13      b     high 294.15 \\\\(101.0\\\\times{10}^{3}\\\\)   287 1.196384\n3: 2018-06-14      c   medium 294.65 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.195536\n4: 2018-06-15      d      low 293.35 \\\\(101.0\\\\times{10}^{3}\\\\)   287 1.199647\n5: 2018-06-16      e     high 293.85 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.198791\n```\n:::\n:::\n\n\n`knitr::kable()` yields the expected output with pressure formatted in engineering notation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(DT, align = \"r\")\n```\n\n::: {.cell-output-display}\n|       date| trial| humidity|    T_K|                    p_Pa|   R|  density|\n|----------:|-----:|--------:|------:|-----------------------:|---:|--------:|\n| 2018-06-12|     a|      low| 294.05| \\(101.1\\times{10}^{3}\\)| 287| 1.197976|\n| 2018-06-13|     b|     high| 294.15| \\(101.0\\times{10}^{3}\\)| 287| 1.196384|\n| 2018-06-14|     c|   medium| 294.65| \\(101.1\\times{10}^{3}\\)| 287| 1.195536|\n| 2018-06-15|     d|      low| 293.35| \\(101.0\\times{10}^{3}\\)| 287| 1.199647|\n| 2018-06-16|     e|     high| 293.85| \\(101.1\\times{10}^{3}\\)| 287| 1.198791|\n:::\n:::\n\n\n\n\n\n\n\n\n### Problem\n\n`kableExtra::kbl()` does not render the math markup as expected. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkableExtra::kbl(DT, align = \"r\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> date </th>\n   <th style=\"text-align:right;\"> trial </th>\n   <th style=\"text-align:right;\"> humidity </th>\n   <th style=\"text-align:right;\"> T_K </th>\n   <th style=\"text-align:right;\"> p_Pa </th>\n   <th style=\"text-align:right;\"> R </th>\n   <th style=\"text-align:right;\"> density </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-12 </td>\n   <td style=\"text-align:right;\"> a </td>\n   <td style=\"text-align:right;\"> low </td>\n   <td style=\"text-align:right;\"> 294.05 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.197976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-13 </td>\n   <td style=\"text-align:right;\"> b </td>\n   <td style=\"text-align:right;\"> high </td>\n   <td style=\"text-align:right;\"> 294.15 </td>\n   <td style=\"text-align:right;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.196384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-14 </td>\n   <td style=\"text-align:right;\"> c </td>\n   <td style=\"text-align:right;\"> medium </td>\n   <td style=\"text-align:right;\"> 294.65 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.195536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-15 </td>\n   <td style=\"text-align:right;\"> d </td>\n   <td style=\"text-align:right;\"> low </td>\n   <td style=\"text-align:right;\"> 293.35 </td>\n   <td style=\"text-align:right;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.199647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-16 </td>\n   <td style=\"text-align:right;\"> e </td>\n   <td style=\"text-align:right;\"> high </td>\n   <td style=\"text-align:right;\"> 293.85 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.198791 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nIn fact, having loaded `kableExtra` above, `knitr::kable()` now fails in the same way.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(DT, align = \"r\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> date </th>\n   <th style=\"text-align:right;\"> trial </th>\n   <th style=\"text-align:right;\"> humidity </th>\n   <th style=\"text-align:right;\"> T_K </th>\n   <th style=\"text-align:right;\"> p_Pa </th>\n   <th style=\"text-align:right;\"> R </th>\n   <th style=\"text-align:right;\"> density </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-12 </td>\n   <td style=\"text-align:right;\"> a </td>\n   <td style=\"text-align:right;\"> low </td>\n   <td style=\"text-align:right;\"> 294.05 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.197976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-13 </td>\n   <td style=\"text-align:right;\"> b </td>\n   <td style=\"text-align:right;\"> high </td>\n   <td style=\"text-align:right;\"> 294.15 </td>\n   <td style=\"text-align:right;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.196384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-14 </td>\n   <td style=\"text-align:right;\"> c </td>\n   <td style=\"text-align:right;\"> medium </td>\n   <td style=\"text-align:right;\"> 294.65 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.195536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-15 </td>\n   <td style=\"text-align:right;\"> d </td>\n   <td style=\"text-align:right;\"> low </td>\n   <td style=\"text-align:right;\"> 293.35 </td>\n   <td style=\"text-align:right;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.199647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2018-06-16 </td>\n   <td style=\"text-align:right;\"> e </td>\n   <td style=\"text-align:right;\"> high </td>\n   <td style=\"text-align:right;\"> 293.85 </td>\n   <td style=\"text-align:right;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.198791 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n\n\n\n### Solution\n\nI found a suggestion from [MathJax](https://docs.mathjax.org/en/v2.7-latest/tex.html) to replace the `$ ... $` delimiters with `\\\\( ... \\\\)`. I wrote a short function (below) to do that. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Substitute math delimiters\nsub_delim <- function(x) {\n  x <- sub(\"\\\\$\", \"\\\\\\\\(\", x) # first $\n  x <- sub(\"\\\\$\", \"\\\\\\\\)\", x) # second $\n}\n\nDT$p_Pa <- sub_delim(DT$p_Pa)\nDT\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         date  trial humidity    T_K                       p_Pa     R  density\n       <Date> <char>   <fctr>  <num>                     <char> <int>    <num>\n1: 2018-06-12      a      low 294.05 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.197976\n2: 2018-06-13      b     high 294.15 \\\\(101.0\\\\times{10}^{3}\\\\)   287 1.196384\n3: 2018-06-14      c   medium 294.65 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.195536\n4: 2018-06-15      d      low 293.35 \\\\(101.0\\\\times{10}^{3}\\\\)   287 1.199647\n5: 2018-06-16      e     high 293.85 \\\\(101.1\\\\times{10}^{3}\\\\)   287 1.198791\n```\n:::\n:::\n\n\n`knitr::kable()` yields the expected output. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(DT, align = \"c\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> date </th>\n   <th style=\"text-align:center;\"> trial </th>\n   <th style=\"text-align:center;\"> humidity </th>\n   <th style=\"text-align:center;\"> T_K </th>\n   <th style=\"text-align:center;\"> p_Pa </th>\n   <th style=\"text-align:center;\"> R </th>\n   <th style=\"text-align:center;\"> density </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-12 </td>\n   <td style=\"text-align:center;\"> a </td>\n   <td style=\"text-align:center;\"> low </td>\n   <td style=\"text-align:center;\"> 294.05 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.197976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-13 </td>\n   <td style=\"text-align:center;\"> b </td>\n   <td style=\"text-align:center;\"> high </td>\n   <td style=\"text-align:center;\"> 294.15 </td>\n   <td style=\"text-align:center;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.196384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-14 </td>\n   <td style=\"text-align:center;\"> c </td>\n   <td style=\"text-align:center;\"> medium </td>\n   <td style=\"text-align:center;\"> 294.65 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.195536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-15 </td>\n   <td style=\"text-align:center;\"> d </td>\n   <td style=\"text-align:center;\"> low </td>\n   <td style=\"text-align:center;\"> 293.35 </td>\n   <td style=\"text-align:center;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.199647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-16 </td>\n   <td style=\"text-align:center;\"> e </td>\n   <td style=\"text-align:center;\"> high </td>\n   <td style=\"text-align:center;\"> 293.85 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.198791 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n`kableExtra::kbl()` yields the expected output.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkableExtra::kbl(DT, align = \"c\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> date </th>\n   <th style=\"text-align:center;\"> trial </th>\n   <th style=\"text-align:center;\"> humidity </th>\n   <th style=\"text-align:center;\"> T_K </th>\n   <th style=\"text-align:center;\"> p_Pa </th>\n   <th style=\"text-align:center;\"> R </th>\n   <th style=\"text-align:center;\"> density </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-12 </td>\n   <td style=\"text-align:center;\"> a </td>\n   <td style=\"text-align:center;\"> low </td>\n   <td style=\"text-align:center;\"> 294.05 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.197976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-13 </td>\n   <td style=\"text-align:center;\"> b </td>\n   <td style=\"text-align:center;\"> high </td>\n   <td style=\"text-align:center;\"> 294.15 </td>\n   <td style=\"text-align:center;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.196384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-14 </td>\n   <td style=\"text-align:center;\"> c </td>\n   <td style=\"text-align:center;\"> medium </td>\n   <td style=\"text-align:center;\"> 294.65 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.195536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-15 </td>\n   <td style=\"text-align:center;\"> d </td>\n   <td style=\"text-align:center;\"> low </td>\n   <td style=\"text-align:center;\"> 293.35 </td>\n   <td style=\"text-align:center;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.199647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> 2018-06-16 </td>\n   <td style=\"text-align:center;\"> e </td>\n   <td style=\"text-align:center;\"> high </td>\n   <td style=\"text-align:center;\"> 293.85 </td>\n   <td style=\"text-align:center;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:center;\"> 287 </td>\n   <td style=\"text-align:center;\"> 1.198791 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nI can use the features from `kableExtra` to print a pretty table.\n\n\n::: {#tbl-pretty .cell tbl-cap='Data frame displayed using kableExtra'}\n\n```{.r .cell-code}\nlibrary(\"kableExtra\")\n\nvar_names <- c(\"Date\", \"Trial\", \"Humidity\", \"Temperature\", \"Pressure\", \"Gas constant\", \"Density\" )\nvar_units <- c(\"\", \"\", \"\", \"[K]\", \"[Pa]\", \"[J/(kg K)]\", \"[kg/m\\\\(^3\\\\)]\")\nvar_align <- \"r\"\n\nDT |> \n  kbl(align = var_align, col.names = var_units) |>\n  column_spec(1:6, color = \"black\", background = \"white\") |>\n  add_header_above(header = var_names, align = var_align, background = \"#c7eae5\", line_sep = 0) |>\n  kable_paper(lightable_options = \"basic\", full_width = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n<tr>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Date</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Trial</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Humidity</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Temperature</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Pressure</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Gas constant</div></th>\n<th style=\"border-bottom:hidden;padding-bottom:0; padding-left:0px;padding-right:0px;text-align: right; padding-right: 4px; padding-left: 4px; background-color: #c7eae5 !important;\" colspan=\"1\"><div style=\"border-bottom: 1px solid #ddd; padding-bottom: 5px; \">Density</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:right;\">  </th>\n   <th style=\"text-align:right;\">  </th>\n   <th style=\"text-align:right;\">  </th>\n   <th style=\"text-align:right;\"> [K] </th>\n   <th style=\"text-align:right;\"> [Pa] </th>\n   <th style=\"text-align:right;\"> [J/(kg K)] </th>\n   <th style=\"text-align:right;\"> [kg/m\\(^3\\)] </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2018-06-12 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> a </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> low </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 294.05 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.197976 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2018-06-13 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> b </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> high </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 294.15 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.196384 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2018-06-14 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> c </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> medium </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 294.65 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.195536 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2018-06-15 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> d </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> low </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 293.35 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(101.0\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.199647 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2018-06-16 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> e </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> high </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 293.85 </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(101.1\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 287 </td>\n   <td style=\"text-align:right;\"> 1.198791 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n\n\n### Follow up\n\nTo address this issue, the next version of `format_power()` will include a new `delim` argument, \n\n        format_power(x, digits, format, omit_power, delim)\n\nthat allows a user to set the math delimiters to `$ ... $` or `\\\\( ... \\\\)`  or even custom left and right markup to suit their environment. \n\n\n\n\n\n\n\n## Fixed exponents\n\nPreparing this post, I adapted a table of water properties from the [hydraulics](https://cran.r-project.org/web/packages/hydraulics/index.html) package to use as an example and discovered another, more subtle issue. First, I'll construct the data frame. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Construct a table of water properties\ntemperature     <- seq(0, 45, 10) + 273.15\ndensity         <- c(1000, 1000, 998, 996, 992)\nspecific_weight <- c(9809, 9807, 9793, 9768, 9734)\nviscosity       <- c(173, 131, 102, 81.7, 67.0) * 1E-8\nbulk_modulus    <- c(202, 210, 218, 225, 228) * 1E+7\n\nwater <- data.table(temperature, density, specific_weight, viscosity,  bulk_modulus)\n\nwater\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   temperature density specific_weight viscosity bulk_modulus\n         <num>   <num>           <num>     <num>        <num>\n1:      273.15    1000            9809  1.73e-06     2.02e+09\n2:      283.15    1000            9807  1.31e-06     2.10e+09\n3:      293.15     998            9793  1.02e-06     2.18e+09\n4:      303.15     996            9768  8.17e-07     2.25e+09\n5:      313.15     992            9734  6.70e-07     2.28e+09\n```\n:::\n:::\n\n\n\n\n\n\n\n\n### Problem\n\nI format all the columns and change the delimiters as described earlier and display the result. The viscosity column reveals the problem. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT <- copy(water)\n\n# 5 signif digits\ncols_to_format <- c(\"temperature\")\nDT[, (cols_to_format) := lapply(.SD, function(x) format_power(x, 5)), .SDcols = cols_to_format]\n\n# 4 signif digits\ncols_to_format <- c(\"specific_weight\")\nDT[, (cols_to_format) := lapply(.SD, function(x) format_power(x, 4)), .SDcols = cols_to_format]\n\n# 3 signif digits\ncols_to_format <- c(\"viscosity\", \"bulk_modulus\")\nDT[, (cols_to_format) := lapply(.SD, function(x) format_power(x)), .SDcols = cols_to_format]\n\n# 3 signif digits omit powers\ncols_to_format <- c(\"density\")\nDT[, (cols_to_format) := lapply(.SD, function(x) format_power(x, omit_power = c(0, 3))), .SDcols = cols_to_format]\n\n# change the delimiters\nDT <- DT[, lapply(.SD, function(x) sub_delim(x))]\n\n# Table \nDT |> \n  kbl(align = \"cclrrrr\") |>\n  kable_paper(lightable_options = \"basic\", full_width = TRUE) |>\n  row_spec(0, background = \"#c7eae5\") |>\n  column_spec(1:5, color = \"black\", background = \"white\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:center;background-color: #c7eae5 !important;\"> temperature </th>\n   <th style=\"text-align:center;background-color: #c7eae5 !important;\"> density </th>\n   <th style=\"text-align:left;background-color: #c7eae5 !important;\"> specific_weight </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> viscosity </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> bulk_modulus </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(273.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(1000\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.809\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.73\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.02\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(283.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(1000\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.807\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.31\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.10\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(293.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(998\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.793\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.02\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.18\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(303.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(996\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.768\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(817\\times{10}^{-9}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.25\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(313.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(992\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.734\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(670\\times{10}^{-9}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.28\\times{10}^{9}\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe viscosity column displays three values using $10^{-6}$ and two using $10^{-9}$. Visually comparing the values in a column is easier if the powers of ten are identical. The table below illustrates the desired result, created by manually editing the two viscosity values. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Manually edit strings to illustrate\nDT$viscosity[4] <- \"\\\\(0.82\\\\times{10}^{-6}\\\\)\"\nDT$viscosity[5] <- \"\\\\(0.67\\\\times{10}^{-6}\\\\)\"\n\n# Table \nDT |> \n  kbl(align = \"cclrrrr\") |>\n  kable_paper(lightable_options = \"basic\", full_width = TRUE) |>\n  row_spec(0, background = \"#c7eae5\") |>\n  column_spec(1:5, color = \"black\", background = \"white\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:center;background-color: #c7eae5 !important;\"> temperature </th>\n   <th style=\"text-align:center;background-color: #c7eae5 !important;\"> density </th>\n   <th style=\"text-align:left;background-color: #c7eae5 !important;\"> specific_weight </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> viscosity </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> bulk_modulus </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(273.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(1000\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.809\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.73\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.02\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(283.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(1000\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.807\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.31\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.10\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(293.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(998\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.793\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(1.02\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.18\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(303.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(996\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.768\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(0.82\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.25\\times{10}^{9}\\) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(313.15\\) </td>\n   <td style=\"text-align:center;color: black !important;background-color: white !important;\"> \\(992\\) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> \\(9.734\\times{10}^{3}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(0.67\\times{10}^{-6}\\) </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> \\(2.28\\times{10}^{9}\\) </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThis revision satisfies two conventions of tabulating empirical engineering information. \n\n1. *Units.* &nbsp; With all the reported values reported to the same power-of-ten, the units can all be interpreted in the same way. In this case for example, the units of the viscosity coefficients (1.73, 1.31, etc.) are all micro-Pascal-seconds ($\\mu$Pa-s). \n\n2. *Uncertainty.* &nbsp; In rewriting the two viscosity values, I changed from three *significant digits* to two *decimal places*, consistent with the assumption that empirical information is reported to the same level of uncertainty unless noted otherwise.  \n\n\n\n\n\n### Potential revision\n\nAdd the `water` data to `formatdown` and the following functionality to `format_power()`. \n\n1. A new argument (perhaps `fixed_power`) that automatically selects a fixed exponent for a numerical vector or permits the user to directly assign a fixed exponent.\n\n        format_power(x, digits, format, omit_power, delim, fixed_power)\n\n1. In conjunction with the fixed power-of-ten, I would also round all numbers in a column to the same number of decimal places to address the uncertainty assumption. This could be a separate argument. \n\n\n\n\n\n\n\n## Units\n\nAnd now for something completely different!\n\nThinking about measurement units, I looked for relevant R packages and found [units](https://CRAN.R-project.org/package=units). With appropriate units, powers-of-ten notation can be practically eliminated. For example, a pressure reading of \\(2.02\\times{10}^{9}\\) Pa can be reported as $2.02$ GPa. \n\nTo illustrate, I start with the basic water data, \n\n\n::: {.cell}\n\n```{.r .cell-code}\nwater\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   temperature density specific_weight viscosity bulk_modulus\n         <num>   <num>           <num>     <num>        <num>\n1:      273.15    1000            9809  1.73e-06     2.02e+09\n2:      283.15    1000            9807  1.31e-06     2.10e+09\n3:      293.15     998            9793  1.02e-06     2.18e+09\n4:      303.15     996            9768  8.17e-07     2.25e+09\n5:      313.15     992            9734  6.70e-07     2.28e+09\n```\n:::\n:::\n\n\nWith tools from the `units` package, I can define a symbol `uP` to represent micropoise (a non-SI viscosity unit equal to 10$^{-7}$ Pa-s). And I can write a short function to convert the numbers from basic units to displayed units, for example, converting Pa to GPa (gigapascal) or Pa-s to $\\mu$P (micropoise).  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"units\")\n\n# Define the uP units\ninstall_unit(\"uP\", \"micropoise\", \"micropoise\")\n\n# Function to assign and convert units \nassign_units <- function(x, base_unit, display_unit) {\n  \n  # convert x to \"Units\" class in base units\n  units(x) <- base_unit\n  \n  # convert from basic to display units\n  units(x) <- as_units(display_unit)\n  \n  # return value\n  x\n}\n```\n:::\n\n\nConvert each column and output the results. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Apply to one variable at a time\nDT <- copy(water)\nDT$temperature     <- assign_units(DT$temperature, \"K\", \"degree_C\")\nDT$density         <- assign_units(DT$density, \"kg/m^3\", \"kg/m^3\")\nDT$specific_weight <- assign_units(DT$specific_weight, \"N/m^3\", \"kN/m^3\")\nDT$viscosity       <- assign_units(DT$viscosity, \"Pa*s\", \"uP\")\nDT$bulk_modulus    <- assign_units(DT$bulk_modulus, \"Pa\", \"GPa\")\n\n# Output\nDT |> \n  kbl(align = \"r\") |>\n  kable_paper(lightable_options = \"basic\", full_width = TRUE) |>\n  row_spec(0, background = \"#c7eae5\") |>\n  column_spec(1:5, color = \"black\", background = \"white\") \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> temperature </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> density </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> specific_weight </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> viscosity </th>\n   <th style=\"text-align:right;background-color: #c7eae5 !important;\"> bulk_modulus </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 0 [°C] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 1000 [kg/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 9.809 [kN/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 17.30 [uP] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2.02 [GPa] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 10 [°C] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 1000 [kg/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 9.807 [kN/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 13.10 [uP] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2.10 [GPa] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 20 [°C] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 998 [kg/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 9.793 [kN/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 10.20 [uP] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2.18 [GPa] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 30 [°C] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 996 [kg/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 9.768 [kN/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 8.17 [uP] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2.25 [GPa] </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 40 [°C] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 992 [kg/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 9.734 [kN/m^3] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 6.70 [uP] </td>\n   <td style=\"text-align:right;color: black !important;background-color: white !important;\"> 2.28 [GPa] </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe entries in the data frame are still numeric but are of the \"Units\" class, enabling math operations among values with compatible units. See the [units](https://r-quantities.github.io/units/) website for details. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(DT)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nClasses 'data.table' and 'data.frame':\t5 obs. of  5 variables:\n $ temperature    : Units: [°C] num  0 10 20 30 40\n $ density        : Units: [kg/m^3] num  1000 1000 998 996 992\n $ specific_weight: Units: [kN/m^3] num  9.81 9.81 9.79 9.77 9.73\n $ viscosity      : Units: [uP] num  17.3 13.1 10.2 8.17 6.7\n $ bulk_modulus   : Units: [GPa] num  2.02 2.1 2.18 2.25 2.28\n - attr(*, \".internal.selfref\")=<externalptr> \n```\n:::\n:::\n\n\nIf I were to refine this table further, I would report the numerical values without labels in each cell, moving the unit labels to a sub-header row. Possible future work. \n\n### Potential revision\n\nIncorporate tools from the `units` package to create a new function (perhaps `format_units()`) that would convert basic units to display units that can substitute for powers-of-ten notation. \n\n\n## Closing\n\nThe new `formatdown` package formats numbers in powers-of-ten notation for inline math markup. A new argument is already in the works for managing the math delimiters. Potential new features include a fixed power-of-tens option as well as replacing powers-of-ten notation with deliberate manipulation of physical units.  \n\n\n### Additional software credits {.appendix}\n\n- [`checkmate`](https://mllg.github.io/checkmate/) for internal function argument checks \n- [`wrapr`](https://winvector.github.io/wrapr/) for internal function authoring tools\n- [`units`](https://r-quantities.github.io/units/) for managing units of  physical quantities \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"..\\..\\site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"..\\..\\site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}