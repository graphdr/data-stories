{
  "hash": "43f0a2d6ccffe6d2a70905379001b5b5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Chart design\"\ndescription: |\n    Redesign JEE charts. \ndate: \"June 12, 2024\"\ndate-format: \"YYYY--MM--DD\"\ncategories: [R, engineering education, chart design]\ncap-location: margin\nimage: \"thumbnail.png\"\ndraft: true\n---\n\n\n\n\n::: callout-note\n## Summary\n\n<em>Another JEE chart redesign for fun.</em>\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(midfieldr)\nlibrary(ggplot2)\nlibrary(tidytext)\nlibrary(ggrepel)\n```\n:::\n\n\n## Background\n\nIn a recent article, the authors etc etc etc [@Fleming+Klopfer+etal:2024]\n\n\n## Software skills\n\nIn the original Table 3, the authors show the frequency of the eight most frequently occurring technical (i.e., software) skills in bachelor's-level postings. \n \n\n::: {.cell tbl-cap='Original Table 3. Frequency [in percent] of technical skills by discipline for bachelor\\'s-level postings.'}\n::: {.cell-output-display}\n\n\n|Skill      | Biomedical| Chemical| Civil| Electrical| Environmental| Mechanical|\n|:----------|----------:|--------:|-----:|----------:|-------------:|----------:|\n|MS Excel   |         39|       44|    39|         39|            42|         44|\n|AutoCAD    |          2|       10|    37|         15|            17|         16|\n|SolidWorks |         17|        6|     1|          8|             0|         26|\n|MATLAB     |          7|        2|     0|          6|             1|          3|\n|SCADA      |          0|        2|     0|          4|             0|          1|\n|FMEA       |         14|        0|     0|          5|             0|         10|\n|Python     |          8|        0|     0|          6|             1|          2|\n|MS Project |          2|        2|     2|          0|             2|          2|\n\n\n:::\n:::\n\n\n<br>\n\nThe author's discussion of this table. \n\n> Microsoft Excel occurs in 39% of bachelor's-level biomedical engineering advertisements. Many advertisements included more than one of these skills. In addition to being important for all educational levels, Microsoft Excel was also the most frequently mentioned technical skill in bachelor's-level job advertisements for all engineering disciplines. Specific engineering disciplines also had additional software preferences: AutoCAD was mentioned in one third of civil engineering job advertisements, and SolidWorks appeared frequently in job advertisements in biomedical engineering and mechanical engineering. \n\n\n\n\nRestructure data \n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT <- melt(DT, \n           id.vars = \"Skill\", \n           variable.name = \"Major\", \n           value.name = \"Percent\")\nDT[, Skill := reorder(factor(Skill), Percent, median)]\nDT[, Major := reorder(factor(Major), Percent, median)]\n```\n:::\n\n\nChart\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(DT, aes(x = Percent, y = Skill)) +\n  geom_point(size = 2.5, shape = 16, color = \"#01665e\") +\n  facet_wrap(vars(Major), \n             ncol = 2, \n             as.table = FALSE) + \n  labs(x = \"Frequency (%)\", \n       y = \"\") +\n  theme(panel.grid.major = element_line(linewidth = 0.6, color = \"gray85\"), \n        axis.ticks = element_blank())\n```\n\n::: {.cell-output-display}\n![Comparing technical (software) skills by engineering discipline. A multiway chart of the data in original Table 3. Rows and panels are in \"graphical order\", that is, increasing median values from left to right and from bottom to top.](index_files/figure-html/table-3-data-1.png){width=672}\n:::\n:::\n\n\nReading a multiway graph\n\n- We can more effectively compare values within a panel than between panels.\n\n- Because rows are ordered, one expects a generally increasing trend within a panel. A response greater or smaller than expected creates a visual asymmetry. The interesting stories are often in these visual anomalies.\n\nWhat the visualization suggests in addition to the authors' original discussion. \n\n- Biomedical has a higher frequency of more skills than other majors, with Mechanical a close second, suggesting these majors expect a greater breadth of software skills than other majors. \n\n- In contrast, Civil and Environmental are interested only in the top two skills: MS Excel and AutoCAD.\n\n\n\n\n\n\n\n## Professional skills\n\nIn the original Table A1, the authors show the frequency of the eight most frequently occurring professional skills in bachelor's-level , Master's-level, and PhD-level postings. \n \n\n::: {.cell tbl-cap='Original Table A1. Professional skills and frequencies for biomedical engineering job advertisements.'}\n::: {.cell-output-display}\n\n\n|skill               | BS| MS| PhD|\n|:-------------------|--:|--:|---:|\n|Learning            | 36| 42|  48|\n|Listening           |  3|  2|   2|\n|Problem solving     | 61| 60|  52|\n|Coordination        | 27| 23|  15|\n|Instructing         | 15| 10|   9|\n|Decisions           | 21| 17|  17|\n|Math                |  9| 13|  16|\n|Monitoring          | 17| 13|  10|\n|Operations analysis | 29| 26|  18|\n|Quality control     |  4|  2|   1|\n|Reading             |  6|  7|   6|\n|Science             | 50| 52|  63|\n|Perceptiveness      |  2|  2|   3|\n|Speaking            |  3|  3|   2|\n|Systems analysis    | 60| 62|  59|\n|Systems evaluation  | 30| 31|  32|\n|Writing             | 31| 31|  28|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndframe <- wrapr::build_frame(\n  \"skill\"        , \"BS\",\t\"MS\",\t\"PhD\" |\n    \"Learning\"           ,\t30,\t34,\t36 |\n    \"Listening\"          ,\t 3,\t 2,\t 3 |\n    \"Problem solving\"    ,  63,\t66,\t65 |\n    \"Coordination\"       ,\t33,\t25,\t23 |\n    \"Instructing\"        ,\t17,\t12,\t 10 |\n    \"Decisions\"          ,\t19,\t19,\t21 |\n    \"Math\"               ,\t 8,\t8,\t10 |\n    \"Monitoring\"         ,\t25,\t19,\t16 |\n    \"Operations analysis\",\t44,\t40,\t45 |\n    \"Quality control\"    ,\t 5,\t 4,\t 3 |\n    \"Reading\"            ,\t 6,\t 4,\t 5 |\n    \"Science\"            ,\t41,\t55,\t73 |\n    \"Perceptiveness\"     ,\t 4,\t 4,\t 2 |\n    \"Speaking\"           ,\t 5,\t 4,\t 5 |\n    \"Systems analysis\"   ,\t47,\t52,\t52 |\n    \"Systems evaluation\" ,\t24,\t23,\t28 |\n    \"Writing\"            ,\t23,\t26,\t28 )\n\nsetDT(dframe)\n\nchemical <- melt(dframe, \n                 id.vars = \"skill\", \n                 variable.name = \"degree\", \n                 value.name = \"frequency\", \n                 variable.factor = FALSE)\nchemical[, major := \"Chemical\"]\nsetcolorder(chemical, c(\"major\", \"degree\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndframe <- wrapr::build_frame(\n  \"skill\"        , \"BS\",\t\"MS\",\t\"PhD\" |\n    \"Learning\"           ,\t28,\t31,\t53 |\n    \"Listening\"          ,\t 3,\t 3,\t 5 |\n    \"Problem solving\"    ,  40,\t46,\t53 |\n    \"Coordination\"       ,\t43,\t41,\t32 |\n    \"Instructing\"        ,\t10,\t 9,\t23 |\n    \"Decisions\"          ,\t15,\t20,\t43 |\n    \"Math\"               ,\t11,\t15,\t55 |\n    \"Monitoring\"         ,\t21,\t20,\t21 |\n    \"Operations analysis\",\t15,\t21,\t36 |\n    \"Quality control\"    ,\t 9,\t 6,\t 5 |\n    \"Reading\"            ,\t 6,\t 8,\t18 |\n    \"Science\"            ,\t23,\t27,\t67 |\n    \"Perceptiveness\"     ,\t 2,\t 2,\t 0 |\n    \"Speaking\"           ,\t 3,\t 3,\t 1 |\n    \"Systems analysis\"   ,\t25,\t38,\t67 |\n    \"Systems evaluation\" ,\t16,\t24,\t47 |\n    \"Writing\"            ,\t25,\t30,\t32 )\n\nsetDT(dframe)\n\ncivil <- melt(dframe, \n                 id.vars = \"skill\", \n                 variable.name = \"degree\", \n                 value.name = \"frequency\", \n                 variable.factor = FALSE)\ncivil[, major := \"Civil\"]\nsetcolorder(civil, c(\"major\", \"degree\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndframe <- wrapr::build_frame(\n  \"skill\"        , \"BS\",\t\"MS\",\t\"PhD\" |\n    \"Learning\"           ,\t30,\t33,\t37 |\n    \"Listening\"          ,\t 3,\t 2,\t 1 |\n    \"Problem solving\"    ,  58,\t61,\t58 |\n    \"Coordination\"       ,\t32,\t26,\t28 |\n    \"Instructing\"        ,\t16,\t 10,\t12 |\n    \"Decisions\"          ,\t18,\t19,\t21 |\n    \"Math\"               ,\t13,\t18,\t40 |\n    \"Monitoring\"         ,\t16,\t15,\t14 |\n    \"Operations analysis\",\t31,\t28,\t31 |\n    \"Quality control\"    ,\t 4,\t 2,\t 0 |\n    \"Reading\"            ,\t 6,\t 4,\t5 |\n    \"Science\"            ,\t33,\t43,\t60 |\n    \"Perceptiveness\"     ,\t 2,\t 2,\t 1 |\n    \"Speaking\"           ,\t 4,\t 4,\t 1 |\n    \"Systems analysis\"   ,\t56,\t68,\t71 |\n    \"Systems evaluation\" ,\t26,\t26,\t31 |\n    \"Writing\"            ,\t23,\t23,\t19 )\n\nsetDT(dframe)\n\nelectrical <- melt(dframe, \n                 id.vars = \"skill\", \n                 variable.name = \"degree\", \n                 value.name = \"frequency\", \n                 variable.factor = FALSE)\nelectrical[, major := \"Electrical\"]\nsetcolorder(electrical, c(\"major\", \"degree\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndframe <- wrapr::build_frame(\n  \"skill\"        , \"BS\",\t\"MS\",\t\"PhD\" |\n    \"Learning\"           ,\t29,\t31,\t41 |\n    \"Listening\"          ,\t 3,\t 3,\t 5 |\n    \"Problem solving\"    ,  57,\t54,\t64 |\n    \"Coordination\"       ,\t44,\t37,\t40 |\n    \"Instructing\"        ,\t15,\t 11,\t19 |\n    \"Decisions\"          ,\t19,\t21,\t28 |\n    \"Math\"               ,\t10,\t8,\t24 |\n    \"Monitoring\"         ,\t31,\t26,\t18 |\n    \"Operations analysis\",\t37,\t37,\t53 |\n    \"Quality control\"    ,\t 7,\t 4,\t 1 |\n    \"Reading\"            ,\t 7,\t 7,\t16 |\n    \"Science\"            ,\t37,\t45,\t65 |\n    \"Perceptiveness\"     ,\t 3,\t 3,\t 1 |\n    \"Speaking\"           ,\t 5,\t 5,\t 12 |\n    \"Systems analysis\"   ,\t46,\t52,\t74 |\n    \"Systems evaluation\" ,\t29,\t34,\t53 |\n    \"Writing\"            ,\t31,\t39,\t39 )\n\nsetDT(dframe)\n\nenviron <- melt(dframe, \n                 id.vars = \"skill\", \n                 variable.name = \"degree\", \n                 value.name = \"frequency\", \n                 variable.factor = FALSE)\nenviron[, major := \"Environmental\"]\nsetcolorder(environ, c(\"major\", \"degree\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndframe <- wrapr::build_frame(\n  \"skill\"        , \"BS\",\t\"MS\",\t\"PhD\" |\n    \"Learning\"           ,\t28,\t33,\t34 |\n    \"Listening\"          ,\t 4,\t 3,\t 5 |\n    \"Problem solving\"    ,  63,\t65,\t68 |\n    \"Coordination\"       ,\t33,\t26,\t24 |\n    \"Instructing\"        ,\t20,\t 15,\t18 |\n    \"Decisions\"          ,\t19,\t21,\t19 |\n    \"Math\"               ,\t10,\t8,\t21 |\n    \"Monitoring\"         ,\t14,\t13,\t10 |\n    \"Operations analysis\",\t33,\t27,\t26 |\n    \"Quality control\"    ,\t 6,\t 2,\t 1 |\n    \"Reading\"            ,\t 5,\t 4,\t3 |\n    \"Science\"            ,\t24,\t31,\t49 |\n    \"Perceptiveness\"     ,\t 3,\t 2,\t 2 |\n    \"Speaking\"           ,\t 4,\t 2,\t 3 |\n    \"Systems analysis\"   ,\t52,\t63,\t69 |\n    \"Systems evaluation\" ,\t24,\t24,\t30 |\n    \"Writing\"            ,\t21,\t21,\t18 )\n\nsetDT(dframe)\n\nmechanical <- melt(dframe, \n                 id.vars = \"skill\", \n                 variable.name = \"degree\", \n                 value.name = \"frequency\", \n                 variable.factor = FALSE)\nmechanical[, major := \"Mechanical\"]\nsetcolorder(mechanical, c(\"major\", \"degree\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDT <- rbindlist(list(biomed, chemical, civil, electrical, environ, mechanical))\n\nggplot(DT, aes(x = frequency, y = reorder(skill, frequency, median))) +\n  facet_grid(reorder(major, frequency, median) ~ degree, \n             as.table = FALSE) +\n  geom_point() +\n  labs(x = \"Frequency (%)\", y = \"\")+\n  theme(panel.grid.major = element_line(linewidth = 0.6, color = \"gray85\"), \n        axis.ticks = element_blank())\n```\n\n::: {.cell-output-display}\n![Comparing professional skills by degree level and major---a multiway chart of the data in tables A1 through A6. Skills and majors are in \"graphical order\", that is, increasing median values from bottom to top.](index_files/figure-html/chart-tbl-A1-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Premiums\n\n\n::: {.cell tbl-cap='Original Table C1. Skill premiums (in dollars) by professional skill for positions requiring a bachelor\\'s degree.'}\n::: {.cell-output-display}\n\n\n|Professional skill  | Biomedical| Chemical| Civil| Electrical| Environmental| Mechanical|\n|:-------------------|----------:|--------:|-----:|----------:|-------------:|----------:|\n|Systems analysis    |       7750|     2000|  5500|       4000|          4000|       2500|\n|Systems evaluation  |       4250|     3000|  7000|       3500|          4500|       1520|\n|Math                |       2000|     -250|  8000|      10000|          2500|      -1000|\n|Decision-making     |       -750|     1500|  7000|       1500|          2500|        500|\n|Coordination        |       -250|     2500|  3500|       1500|          4000|        500|\n|Operations analysis |       1000|     1340|  6000|          0|          2750|        500|\n|Science             |      -2000|     -500|  3000|       6500|           500|       2500|\n|Problem solving     |       4000|     -250|  2500|          0|          3500|          0|\n|Monitoring          |       4500|     -500|  2500|       1250|         -1500|       2000|\n|Writing             |       1750|     -500|  2000|          0|          -500|      -1000|\n|Listening           |         NA|     2000|   250|      -4500|          1000|      -1500|\n|Learning            |      -1500|    -2000| -2000|        650|         -1500|        500|\n|Reading             |      -9500|     2750| -1750|        500|          1250|       -250|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskill_prof <- melt(skill_prof, \n           id.vars = \"Professional skill\", \n           variable.name = \"major\", \n           value.name = \"premium\", \n           variable.factor = FALSE)\nskill_prof[, skill_group := \"Professional\"]\nsetnames(skill_prof, old = c(\"Professional skill\"), new = c(\"skill\"))\nsetcolorder(skill_prof, c(\"skill_group\"))\nskill_prof\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     skill_group              skill      major premium\n          <char>             <char>     <char>   <num>\n 1: Professional   Systems analysis Biomedical    7750\n 2: Professional Systems evaluation Biomedical    4250\n 3: Professional               Math Biomedical    2000\n 4: Professional    Decision-making Biomedical    -750\n 5: Professional       Coordination Biomedical    -250\n---                                                   \n74: Professional         Monitoring Mechanical    2000\n75: Professional            Writing Mechanical   -1000\n76: Professional          Listening Mechanical   -1500\n77: Professional           Learning Mechanical     500\n78: Professional            Reading Mechanical    -250\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- midfieldr::order_multiway(\n  dframe     = skill_prof,\n  quantity   = \"premium\",\n  categories = c(\"skill\", \"major\"),\n  method     = \"median\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(x, aes(x = premium/1000, y = skill)) +\n  geom_vline(aes(xintercept = major_median/1000), linetype = 2, color = \"gray40\") +\n  geom_point(size = 2.5, shape = 16, color = \"#01665e\") +\n  facet_wrap(vars(major), as.table = FALSE, ncol = 3) + \n  labs(x = \"Premium (thousands USD)\", y = \"\") +\n  theme(panel.grid.major = element_line(linewidth = 0.6, color = \"gray85\")) \n```\n\n::: {.cell-output-display}\n![Comparing the professional skill premiums by major.](index_files/figure-html/table-C1-data-1.png){width=672}\n:::\n:::\n\n::: {.cell tbl-cap='Original Table C2. Skill premiums (in dollars) by technical skill for positions requiring a bachelor\\'s degree.'}\n::: {.cell-output-display}\n\n\n|Technical skill | Biomedical| Chemical| Civil| Electrical| Environmental| Mechanical|\n|:---------------|----------:|--------:|-----:|----------:|-------------:|----------:|\n|MATLAB          |      19000|     4000|    NA|      11250|         18000|      10000|\n|Python          |      18250|     5000|    NA|      11750|          2500|      17000|\n|SCADA           |         NA|     9000|    NA|       2500|            NA|         NA|\n|FMEA            |       9500|     1250|    NA|        500|          1250|       1000|\n|Project         |         NA|     5950| -1500|       4750|          2000|       1750|\n|SolidWorks      |       3000|     -250|    NA|      -7500|          2000|       -500|\n|Excel           |      -2000|    -2500| -3000|      -6000|         -5020|      -2000|\n|PowerPoint      |      -4000|    -4200|  -500|      -7000|         -3500|      -1750|\n|AutoCAD         |         NA|    -1000| -5000|      -6500|         -6000|      -3500|\n|Word            |      -7250|    -5000| -5250|      -5500|         -6500|      -4500|\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nskill_tech <- melt(skill_tech, \n           id.vars = \"Technical skill\", \n           variable.name = \"major\", \n           value.name = \"premium\", \n           variable.factor = FALSE)\nskill_tech[, skill_group := \"Software\"]\nsetnames(skill_tech, old = c(\"Technical skill\"), new = c(\"skill\"))\nsetcolorder(skill_tech, c(\"skill_group\"))\nskill_tech\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    skill_group      skill         major premium\n         <char>     <char>        <char>   <num>\n 1:    Software     MATLAB    Biomedical   19000\n 2:    Software     Python    Biomedical   18250\n 3:    Software      SCADA    Biomedical      NA\n 4:    Software       FMEA    Biomedical    9500\n 5:    Software    Project    Biomedical      NA\n 6:    Software SolidWorks    Biomedical    3000\n 7:    Software      Excel    Biomedical   -2000\n 8:    Software PowerPoint    Biomedical   -4000\n 9:    Software    AutoCAD    Biomedical      NA\n10:    Software       Word    Biomedical   -7250\n11:    Software     MATLAB      Chemical    4000\n12:    Software     Python      Chemical    5000\n13:    Software      SCADA      Chemical    9000\n14:    Software       FMEA      Chemical    1250\n15:    Software    Project      Chemical    5950\n16:    Software SolidWorks      Chemical    -250\n17:    Software      Excel      Chemical   -2500\n18:    Software PowerPoint      Chemical   -4200\n19:    Software    AutoCAD      Chemical   -1000\n20:    Software       Word      Chemical   -5000\n21:    Software     MATLAB         Civil      NA\n22:    Software     Python         Civil      NA\n23:    Software      SCADA         Civil      NA\n24:    Software       FMEA         Civil      NA\n25:    Software    Project         Civil   -1500\n26:    Software SolidWorks         Civil      NA\n27:    Software      Excel         Civil   -3000\n28:    Software PowerPoint         Civil    -500\n29:    Software    AutoCAD         Civil   -5000\n30:    Software       Word         Civil   -5250\n31:    Software     MATLAB    Electrical   11250\n32:    Software     Python    Electrical   11750\n33:    Software      SCADA    Electrical    2500\n34:    Software       FMEA    Electrical     500\n35:    Software    Project    Electrical    4750\n36:    Software SolidWorks    Electrical   -7500\n37:    Software      Excel    Electrical   -6000\n38:    Software PowerPoint    Electrical   -7000\n39:    Software    AutoCAD    Electrical   -6500\n40:    Software       Word    Electrical   -5500\n41:    Software     MATLAB Environmental   18000\n42:    Software     Python Environmental    2500\n43:    Software      SCADA Environmental      NA\n44:    Software       FMEA Environmental    1250\n45:    Software    Project Environmental    2000\n46:    Software SolidWorks Environmental    2000\n47:    Software      Excel Environmental   -5020\n48:    Software PowerPoint Environmental   -3500\n49:    Software    AutoCAD Environmental   -6000\n50:    Software       Word Environmental   -6500\n51:    Software     MATLAB    Mechanical   10000\n52:    Software     Python    Mechanical   17000\n53:    Software      SCADA    Mechanical      NA\n54:    Software       FMEA    Mechanical    1000\n55:    Software    Project    Mechanical    1750\n56:    Software SolidWorks    Mechanical    -500\n57:    Software      Excel    Mechanical   -2000\n58:    Software PowerPoint    Mechanical   -1750\n59:    Software    AutoCAD    Mechanical   -3500\n60:    Software       Word    Mechanical   -4500\n    skill_group      skill         major premium\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- midfieldr::order_multiway(\n  dframe     = x,\n  quantity   = \"premium\",\n  categories = c(\"skill\", \"major\"),\n  method     = \"median\"\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(x, aes(x = premium/1000, y = skill)) +\n    geom_vline(aes(xintercept = major_median/1000), linetype = 2, color = \"gray40\") +\n  geom_point(size = 2.5, shape = 16, color = \"#01665e\") +\n  facet_wrap(vars(major), as.table = FALSE, ncol = 3) + \n  labs(x = \"Premium (thousands USD)\", y = \"\") +\n  theme(panel.grid.major = element_line(linewidth = 0.6, color = \"gray85\")) \n```\n\n::: {.cell-output-display}\n![Comparing the technical skill premiums by major.](index_files/figure-html/table-C2-data-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nDT <- rbindlist(list(skill_prof, skill_tech))\nDT\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      skill_group              skill      major premium\n           <char>             <char>     <char>   <num>\n  1: Professional   Systems analysis Biomedical    7750\n  2: Professional Systems evaluation Biomedical    4250\n  3: Professional               Math Biomedical    2000\n  4: Professional    Decision-making Biomedical    -750\n  5: Professional       Coordination Biomedical    -250\n ---                                                   \n134:     Software         SolidWorks Mechanical    -500\n135:     Software              Excel Mechanical   -2000\n136:     Software         PowerPoint Mechanical   -1750\n137:     Software            AutoCAD Mechanical   -3500\n138:     Software               Word Mechanical   -4500\n```\n\n\n:::\n\n```{.r .cell-code}\nDT <- DT[!is.na(premium)]\nDT[, premium := premium / 1000]\n\n\n\n\nDT[, rank := frankv(premium, order = 1), by = c(\"major\")]\nsetorderv(DT, cols = c(\"major\", \"rank\"), order = -1)\nDT[, cutoff := rank[10], by = c(\"major\")]\nDT <- DT[rank >= cutoff]\nDT[, sum_premium := sum(premium), by = c(\"major\")]\nDT[, max_rank := max(rank), by = c(\"skill_group\", \"major\")]\nDT\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     skill_group              skill      major premium  rank cutoff sum_premium\n          <char>             <char>     <char>   <num> <num>  <num>       <num>\n 1:     Software             Python Mechanical   17.00  22.0   12.5       40.27\n 2:     Software             MATLAB Mechanical   10.00  21.0   12.5       40.27\n 3: Professional   Systems analysis Mechanical    2.50  19.5   12.5       40.27\n 4: Professional            Science Mechanical    2.50  19.5   12.5       40.27\n 5: Professional         Monitoring Mechanical    2.00  18.0   12.5       40.27\n---                                                                            \n59: Professional Systems evaluation Biomedical    4.25  14.0   10.0       74.00\n60: Professional    Problem solving Biomedical    4.00  13.0   10.0       74.00\n61:     Software         SolidWorks Biomedical    3.00  12.0   10.0       74.00\n62: Professional               Math Biomedical    2.00  11.0   10.0       74.00\n63: Professional            Writing Biomedical    1.75  10.0   10.0       74.00\n    max_rank\n       <num>\n 1:     22.0\n 2:     22.0\n 3:     19.5\n 4:     19.5\n 5:     19.5\n---         \n59:     16.0\n60:     16.0\n61:     19.0\n62:     16.0\n63:     16.0\n```\n\n\n:::\n\n```{.r .cell-code}\n# DT[, cutoff := max(max_rank) - 7, by = major]\n\n# x <- copy(DT)\n# setorderv(x, c(\"major\", \"rank\"), order = -1)\n# x <- x[, .SD[1:8], by = c(\"major\")]\n# x[, sum_premium := sum(premium), by = c(\"major\")]\n# x <- x[, .(major, sum_premium)]\n# x <- unique(x)\n# x\n# \n# DT <- DT[x, on = \"major\"]\n\nmy_legend <- copy(DT)\nsetorderv(my_legend, c(\"skill\"), order = -1)\nmy_legend <- my_legend[rank == max_rank]\nmy_legend <- my_legend[, .SD[1], by = c(\"major\", \"skill_group\")]\nmy_legend\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            major  skill_group              skill premium  rank cutoff\n           <char>       <char>             <char>   <num> <num>  <num>\n 1: Environmental Professional Systems evaluation    4.50  21.0   12.5\n 2:      Chemical Professional Systems evaluation    3.00  19.0   14.0\n 3:    Mechanical Professional   Systems analysis    2.50  19.5   12.5\n 4:    Biomedical Professional   Systems analysis    7.75  16.0   10.0\n 5:      Chemical     Software              SCADA    9.00  23.0   14.0\n 6:    Mechanical     Software             Python   17.00  22.0   12.5\n 7:    Electrical     Software             Python   11.75  23.0   14.5\n 8:    Electrical Professional               Math   10.00  21.0   14.5\n 9:         Civil Professional               Math    8.00  18.0    9.0\n10: Environmental     Software             MATLAB   18.00  22.0   12.5\n11:    Biomedical     Software             MATLAB   19.00  19.0   10.0\n    sum_premium max_rank\n          <num>    <num>\n 1:       48.25     21.0\n 2:       37.70     19.0\n 3:       40.27     19.5\n 4:       74.00     16.0\n 5:       37.70     23.0\n 6:       40.27     22.0\n 7:       57.25     23.0\n 8:       57.25     21.0\n 9:       47.00     18.0\n10:       48.25     22.0\n11:       74.00     19.0\n```\n\n\n:::\n\n```{.r .cell-code}\nmy_legend\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            major  skill_group              skill premium  rank cutoff\n           <char>       <char>             <char>   <num> <num>  <num>\n 1: Environmental Professional Systems evaluation    4.50  21.0   12.5\n 2:      Chemical Professional Systems evaluation    3.00  19.0   14.0\n 3:    Mechanical Professional   Systems analysis    2.50  19.5   12.5\n 4:    Biomedical Professional   Systems analysis    7.75  16.0   10.0\n 5:      Chemical     Software              SCADA    9.00  23.0   14.0\n 6:    Mechanical     Software             Python   17.00  22.0   12.5\n 7:    Electrical     Software             Python   11.75  23.0   14.5\n 8:    Electrical Professional               Math   10.00  21.0   14.5\n 9:         Civil Professional               Math    8.00  18.0    9.0\n10: Environmental     Software             MATLAB   18.00  22.0   12.5\n11:    Biomedical     Software             MATLAB   19.00  19.0   10.0\n    sum_premium max_rank\n          <num>    <num>\n 1:       48.25     21.0\n 2:       37.70     19.0\n 3:       40.27     19.5\n 4:       74.00     16.0\n 5:       37.70     23.0\n 6:       40.27     22.0\n 7:       57.25     23.0\n 8:       57.25     21.0\n 9:       47.00     18.0\n10:       48.25     22.0\n11:       74.00     19.0\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- copy(DT)\nx <- x[rank >= cutoff]\nx[, max_rank := max_rank - cutoff]\nx[, rank := rank - cutoff]\nx[, cutoff := 0]\n\n\n# my_legend[, max_rank := max_rank - cutoff]\n# my_legend[, rank := rank - cutoff]\n# my_legend[, cutoff := 0]\n\n\n\nggplot(x, aes(x = premium, \n               y = reorder_within(x = skill, \n                                  by = premium, \n                                  within = major), \n               color = skill_group, \n               fill = skill_group)) +\n  # geom_vline(xintercept = 0, color = \"gray70\", linetype = 2) +\n  # geom_hline(data = my_legend, \n  #            aes(yintercept = cutoff), \n  #            color = \"gray70\", \n  #            linetype = 2) +\n  geom_point(size = 2.5, shape = 21) +\n  labs(x = \"Premium (x$1000)\", y = \"\") +\n  facet_wrap(vars(reorder(major, sum_premium)), \n             ncol = 2, \n             scales = \"free_y\", \n             as.table = FALSE) +\n  scale_y_discrete(labels = function(x) gsub(\"__.+$\", \"\", x)) +\n  scale_x_continuous(limits = c(0, 23), breaks = seq(-20, 30, 5)) +\n  # geom_text(data = my_legend, \n  #           aes(x = premium, y = max_rank, label = skill_group), \n  #           hjust = -0.1, \n  #           vjust = 0.7) +\n  theme(legend.position = \"top\", \n        legend.title = element_blank(), \n        axis.ticks = element_blank(), \n        panel.grid.major = element_line(linewidth = 0.6, color = \"gray85\")) +\n  # expand_limits(y = c(0)) +\n  scale_fill_manual(values = c(\"#80cdc1\", \"#bf812d\")) +\n  scale_color_manual(values = c(\"#01665e\", \"#8c510a\")) \n```\n\n::: {.cell-output-display}\n![Comparing the top 10 premiums for professional skills and software by major. The vertical scales are different in each panel, ordered by increasing premiums in that major.](index_files/figure-html/table-C1-C2-data-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  # geom_text(data = my_legend, \n  #           aes(x = -10, y = cutoff + 4, label = \"Top 8 premiums\"), \n  #           color = \"gray40\", \n  #           hjust = 0)\n```\n:::\n\n\n\n## References\n\n \n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}