{
  "hash": "1438aa5f438059c631202a5132816fad",
  "result": {
    "markdown": "---\ntitle: \"Alternative to radar charts\"\ndescription: |\n  Study.\ndate: \"2022-08-05\"\ndate-format: \"YYYY-MM-DD\"\ncategories: [R]\nimage: \"thumbnail.png\"\ncap-location: margin\ndraft: true\n---\n\n\n\n\n\n\n\n:::{.callout-note}\n## Summary \n<em>TBD</em>\n:::\n\nSummary\n\nThe R code for the post is listed under the “R code” pointers. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# packages used \nlibrary(\"data.table\")\nlibrary(\"ggplot2\")\nlibrary(\"ggpubfigs\")\nlibrary(\"fmsb\")\nlibrary(\"ggradar\")\nlibrary(\"graphclassmate\")\n```\n:::\n\n\n\n## stuff\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create data\ndf <- data.frame(Mon = c(100, 0, 34),\n                 Tue = c(100, 0, 48),\n                 Wed = c(100, 0, 58),\n                 Thu = c(100, 0, 67),\n                 Fri = c(100, 0, 55),\n                 Sat = c(100, 0, 29),\n                 Sun = c(100, 0, 18))\n                  \n# view data\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Mon Tue Wed Thu Fri Sat Sun\n1 100 100 100 100 100 100 100\n2   0   0   0   0   0   0   0\n3  34  48  58  67  55  29  18\n```\n:::\n\n```{.r .cell-code}\nradarchart(df)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Data must be given as the data frame, where the first cases show maximum.\nmaxmin <- data.frame(\n  total=c(5, 1),\n  phys=c(15, 3),\n  psycho=c(3, 0),\n  social=c(5, 1),\n  env=c(5, 1))\n# data for radarchart function version 1 series, minimum value must be omitted from above.\nRNGkind(\"Mersenne-Twister\")\nset.seed(123)\ndat <- data.frame(\n  total  = runif(3, 1, 5),\n  phys   = rnorm(3, 10, 2),\n  psycho = c(0.5, NA, 3),\n  social = runif(3, 1, 5),\n  env    = c(5, 2.5, 4)\n  )\ndat <- rbind(maxmin, dat)\nop  <- par(mar = c(1, 2, 2, 1), mfrow = c(1, 1))\n\nradarchart(dat, \n           axistyp = 1, \n           seg     = 5, \n           plty    = 1, \n           vlabels = c(\"Total\\nQOL\", \n                       \"Physical\\naspects\", \n                       \"Phychological\\naspects\", \n                       \"Social\\naspects\", \n                       \"Environmental\\naspects\"),\n           title   = \"(axis = 1, 5 segments, with specified vlabels)\", \n           vlcex   = 0.5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# radarchart(dat, \n#            axistype = 2, \n#            pcol     = topo.colors(3), \n#            plty     = 1, \n#            pdensity = c(5, 10, 30),\n#            pangle   = c(10, 45, 120), \n#            pfcol    = topo.colors(3),\n#            title    = \"(topo.colors, fill, axis = 2)\")\n# \n# radarchart(dat, \n#            axistype   = 3, \n#            pty        = 32, \n#            plty       = 1, \n#            axislabcol = \"grey\", \n#            na.itp     = FALSE,\n#            title      = \"(no points, axis = 3, na.itp = FALSE)\")\n# \n# radarchart(dat, \n#            axistype = 1, \n#            plwd     = 1:5, \n#            pcol     = 1, \n#            centerzero  = TRUE,\n#            seg         = 4, \n#            caxislabels = c(\"worst\", \"\", \"\", \"\", \"best\"),\n#            title       = \"(use lty and lwd but b/w, axis=1,\\n centerzero=TRUE, with centerlabels)\")\n\npar(op)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Demo data\nexam_scores <- data.frame(\n    row.names = c(\"Student.1\", \"Student.2\", \"Student.3\"),\n      Biology = c(7.9, 3.9, 9.4),\n      Physics = c(10, 20, 0),\n        Maths = c(3.7, 11.5, 2.5),\n        Sport = c(8.7, 20, 4),\n      English = c(7.9, 7.2, 12.4),\n    Geography = c(6.4, 10.5, 6.5),\n          Art = c(2.4, 0.2, 9.8),\n  Programming = c(0, 0, 20),\n        Music = c(20, 20, 20)\n)\nexam_scores\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          Biology Physics Maths Sport English Geography Art Programming Music\nStudent.1     7.9      10   3.7   8.7     7.9       6.4 2.4           0    20\nStudent.2     3.9      20  11.5  20.0     7.2      10.5 0.2           0    20\nStudent.3     9.4       0   2.5   4.0    12.4       6.5 9.8          20    20\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n# Put row names into  a column named group\ndf <- exam_scores %>% rownames_to_column(\"group\")\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      group Biology Physics Maths Sport English Geography Art Programming Music\n1 Student.1     7.9      10   3.7   8.7     7.9       6.4 2.4           0    20\n2 Student.2     3.9      20  11.5  20.0     7.2      10.5 0.2           0    20\n3 Student.3     9.4       0   2.5   4.0    12.4       6.5 9.8          20    20\n```\n:::\n\n```{.r .cell-code}\n# Plotting student 1\nggradar(\n  df[1, ], \n  values.radar = c(\"0\", \"10\", \"20\"),\n  grid.min = 0, grid.mid = 10, grid.max = 20\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggradar(\n  df[1, ], \n  values.radar = c(\"0\", \"10\", \"20\"),\n  grid.min = 0, grid.mid = 10, grid.max = 20,\n  # Polygons\n  group.line.width = 1, \n  group.point.size = 3,\n  group.colours = \"#00AFBB\",\n  # Background and grid lines\n  background.circle.colour = \"white\",\n  gridline.mid.colour = \"grey\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggradar(\n  df, \n  values.radar = c(\"0\", \"10\", \"20\"),\n  grid.min = 0, grid.mid = 10, grid.max = 20,\n  # Polygons\n  group.line.width = 1, \n  group.point.size = 3,\n  group.colours = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  # Background and grid lines\n  background.circle.colour = \"white\",\n  gridline.mid.colour = \"grey\",\n  legend.position = \"bottom\"\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(GGally)\nggparcoord(\n  iris,\n  columns = 1:4, groupColumn = 5, order = \"anyClass\",\n  showPoints = TRUE, \n  title = \"Parallel Coordinate Plot for the Iris Data\",\n  alphaLines = 0.3\n  ) + \n  theme_bw() +\n  theme(legend.position = \"top\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n## Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt <- wrapr::build_frame(\n  \"Bacteria\", \"Penicillin\", \"Streptomycin\", \"Neomycin\", \"Gram_staining\" |\n    \"Aerobacter aerogenes\"           , 870     ,  1   ,  1.6  , \"Stain-negative\" |\n    \"Bacillus anthracis\"             ,   0.001 ,  0.01,  0.007, \"Stain-positive\" |\n    \"Brucella abortus\"               ,   1     ,  2   ,  0.02 , \"Stain-negative\" |\n    \"Diplococcus pneumoniae\"         ,   0.0005, 11   , 10    , \"Stain-positive\" |\n    \"Escherichia coli\"               , 100     ,  0.4 ,  0.1  , \"Stain-negative\" |\n    \"Klebsiella pneumoniae\"          , 850     ,  1.2 ,  1    , \"Stain-negative\" |\n    \"Mycobacterium tuberculosis\"     , 800     ,  5   ,  2    , \"Stain-negative\" |\n    \"Proteus vulgaris\"               ,   3     ,  0.1 ,  0.1  , \"Stain-negative\" |\n    \"Pseudomonas aeruginosa\"         , 850     ,  2   ,  0.4  , \"Stain-negative\" |\n    \"Salmonella typhosa\",   1     ,  0.4 ,  0.008, \"Stain-negative\" |\n    \"Salmonella schottmuelleri\"      ,  10     ,  0.8 ,  0.09 , \"Stain-negative\" |\n    \"Staphylococcus albus\"           ,   0.007 ,  0.1 ,  0.001, \"Stain-positive\" |\n    \"Staphylococcus aureus\"          ,   0.03  ,  0.03,  0.001, \"Stain-positive\" |\n    \"Streptococcus faecalis\"         ,   1     ,  1   ,  0.1  , \"Stain-positive\" |\n    \"Streptococcus hemolyticus\"      ,   0.001 , 14   , 10    , \"Stain-positive\" |\n    \"Streptococcus viridans\"         ,   0.005 , 10   , 40    , \"Stain-positive\"\n)\n\ndt <- wrapr::build_frame(\n  \"Bacteria\", \"Penicillin\", \"Streptomycin\", \"Neomycin\", \"Gram_staining\" |\n    \"A. aerogenes\"        , 870     ,  1    ,  1.6  , \"Stain-negative\" |\n    \"B. anthracis\"        ,   0.001 ,  0.01 ,  0.007, \"Stain-positive\" |\n    \"B. abortus\"          ,   1     ,  2    ,  0.02 , \"Stain-negative\" |\n    \"D. pneumoniae\"       ,   0.0005, 11    , 10    , \"Stain-positive\" |\n    \"E. coli\"             , 100     ,  0.4  ,  0.1  , \"Stain-negative\" |\n    \"K. pneumoniae\"       , 850     ,  1.2  ,  1    , \"Stain-negative\" |\n    \"M. tuberculosis\"     , 800     ,  5    ,  2    , \"Stain-negative\" |\n    \"P. vulgaris\"         ,   3     ,  0.1  ,  0.1  , \"Stain-negative\" |\n    \"P. aeruginosa\"       , 850     ,  2    ,  0.4  , \"Stain-negative\" |\n    \"S. typhosa\"          ,   1     ,  0.4  ,  0.008, \"Stain-negative\" |\n    \"S. schottmuelleri\"   ,  10     ,  0.8  ,  0.09 , \"Stain-negative\" |\n    \"S. albus\"            ,   0.007 ,  0.1  ,  0.001, \"Stain-positive\" |\n    \"S. aureus\"           ,   0.03  ,  0.03 ,  0.001, \"Stain-positive\" |\n    \"S. faecalis\"         ,   1     ,  1    ,  0.1  , \"Stain-positive\" |\n    \"S. hemolyticus\"      ,   0.001 , 14    , 10    , \"Stain-positive\" |\n    \"S. viridans\"         ,   0.005 , 10    , 40    , \"Stain-positive\"\n)\ndt <- data.table(dt)\n```\n:::\n\n`\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndt <- melt(dt, \n           id.vars = c(\"Bacteria\", \"Gram_staining\"), \n           variable.name = \"Antibiotic\", \n           variable.factor = FALSE, \n           value.name = \"Concentration\")\ndt[, Antibiotic := factor(Antibiotic, \n                        levels = c(\"Penicillin\", \"Streptomycin\", \"Neomycin\"))]\n\n# order by increasing doses of penicillin\nthis_order <- dt[Antibiotic == \"Penicillin\"]\nsetorderv(this_order, c(\"Concentration\"))\nthis_order[, row_order := -1*seq.int(nrow(this_order))]\nthis_order <- this_order[, .(Bacteria, row_order)]\n\ndt <- merge(dt, this_order, by = \"Bacteria\", all.x = TRUE)\ndt[, panel_fill := \"pink\"]\ndt <- dt[Gram_staining == \"Stain-positive\", panel_fill := \"cornflowerblue\"]\ndt[]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Bacteria  Gram_staining   Antibiotic Concentration row_order\n               <char>         <char>       <fctr>         <num>     <num>\n 1:      A. aerogenes Stain-negative   Penicillin       8.7e+02       -16\n 2:      A. aerogenes Stain-negative Streptomycin       1.0e+00       -16\n 3:      A. aerogenes Stain-negative     Neomycin       1.6e+00       -16\n 4:        B. abortus Stain-negative   Penicillin       1.0e+00        -7\n 5:        B. abortus Stain-negative Streptomycin       2.0e+00        -7\n 6:        B. abortus Stain-negative     Neomycin       2.0e-02        -7\n 7:      B. anthracis Stain-positive   Penicillin       1.0e-03        -2\n 8:      B. anthracis Stain-positive Streptomycin       1.0e-02        -2\n 9:      B. anthracis Stain-positive     Neomycin       7.0e-03        -2\n10:     D. pneumoniae Stain-positive   Penicillin       5.0e-04        -1\n11:     D. pneumoniae Stain-positive Streptomycin       1.1e+01        -1\n12:     D. pneumoniae Stain-positive     Neomycin       1.0e+01        -1\n13:           E. coli Stain-negative   Penicillin       1.0e+02       -12\n14:           E. coli Stain-negative Streptomycin       4.0e-01       -12\n15:           E. coli Stain-negative     Neomycin       1.0e-01       -12\n16:     K. pneumoniae Stain-negative   Penicillin       8.5e+02       -14\n17:     K. pneumoniae Stain-negative Streptomycin       1.2e+00       -14\n18:     K. pneumoniae Stain-negative     Neomycin       1.0e+00       -14\n19:   M. tuberculosis Stain-negative   Penicillin       8.0e+02       -13\n20:   M. tuberculosis Stain-negative Streptomycin       5.0e+00       -13\n21:   M. tuberculosis Stain-negative     Neomycin       2.0e+00       -13\n22:     P. aeruginosa Stain-negative   Penicillin       8.5e+02       -15\n23:     P. aeruginosa Stain-negative Streptomycin       2.0e+00       -15\n24:     P. aeruginosa Stain-negative     Neomycin       4.0e-01       -15\n25:       P. vulgaris Stain-negative   Penicillin       3.0e+00       -10\n26:       P. vulgaris Stain-negative Streptomycin       1.0e-01       -10\n27:       P. vulgaris Stain-negative     Neomycin       1.0e-01       -10\n28:          S. albus Stain-positive   Penicillin       7.0e-03        -5\n29:          S. albus Stain-positive Streptomycin       1.0e-01        -5\n30:          S. albus Stain-positive     Neomycin       1.0e-03        -5\n31:         S. aureus Stain-positive   Penicillin       3.0e-02        -6\n32:         S. aureus Stain-positive Streptomycin       3.0e-02        -6\n33:         S. aureus Stain-positive     Neomycin       1.0e-03        -6\n34:       S. faecalis Stain-positive   Penicillin       1.0e+00        -9\n35:       S. faecalis Stain-positive Streptomycin       1.0e+00        -9\n36:       S. faecalis Stain-positive     Neomycin       1.0e-01        -9\n37:    S. hemolyticus Stain-positive   Penicillin       1.0e-03        -3\n38:    S. hemolyticus Stain-positive Streptomycin       1.4e+01        -3\n39:    S. hemolyticus Stain-positive     Neomycin       1.0e+01        -3\n40: S. schottmuelleri Stain-negative   Penicillin       1.0e+01       -11\n41: S. schottmuelleri Stain-negative Streptomycin       8.0e-01       -11\n42: S. schottmuelleri Stain-negative     Neomycin       9.0e-02       -11\n43:        S. typhosa Stain-negative   Penicillin       1.0e+00        -8\n44:        S. typhosa Stain-negative Streptomycin       4.0e-01        -8\n45:        S. typhosa Stain-negative     Neomycin       8.0e-03        -8\n46:       S. viridans Stain-positive   Penicillin       5.0e-03        -4\n47:       S. viridans Stain-positive Streptomycin       1.0e+01        -4\n48:       S. viridans Stain-positive     Neomycin       4.0e+01        -4\n             Bacteria  Gram_staining   Antibiotic Concentration row_order\n        panel_fill\n            <char>\n 1:           pink\n 2:           pink\n 3:           pink\n 4:           pink\n 5:           pink\n 6:           pink\n 7: cornflowerblue\n 8: cornflowerblue\n 9: cornflowerblue\n10: cornflowerblue\n11: cornflowerblue\n12: cornflowerblue\n13:           pink\n14:           pink\n15:           pink\n16:           pink\n17:           pink\n18:           pink\n19:           pink\n20:           pink\n21:           pink\n22:           pink\n23:           pink\n24:           pink\n25:           pink\n26:           pink\n27:           pink\n28: cornflowerblue\n29: cornflowerblue\n30: cornflowerblue\n31: cornflowerblue\n32: cornflowerblue\n33: cornflowerblue\n34: cornflowerblue\n35: cornflowerblue\n36: cornflowerblue\n37: cornflowerblue\n38: cornflowerblue\n39: cornflowerblue\n40:           pink\n41:           pink\n42:           pink\n43:           pink\n44:           pink\n45:           pink\n46: cornflowerblue\n47: cornflowerblue\n48: cornflowerblue\n        panel_fill\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndt[, log10_conc := log10(Concentration)]\n```\n:::\n\n\n\n\n\n\n## Charts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# x <- dt[Gram_staining == \"Stain-negative\", .(Bacteria, Antibiotic, Concentration)]\n# radarchart(x)\n```\n:::\n\n::: {.cell fig.asp='0.95'}\n\n```{.r .cell-code}\nlibrary(ggtext)\nx <- dt[Gram_staining == \"Stain-positive\", .(Bacteria, Antibiotic, log10_conc)]\nx <- dcast(x, Antibiotic ~ Bacteria)\nsetcolorder(x, c(1, 5, 6, 2, 3, 7, 8, 4))\n\nggradar(\n  x, \n  values.radar = c(-3, -1, 3),\n  grid.min = -3, \n  grid.mid = -1, \n  grid.max =  3,\n  centre.y = -4, \n  plot.extent.x.sf = 1.25, \n  plot.extent.y.sf = 1.25, \n  group.line.width = 1, \n  group.point.size = 3,\n  gridline.label.offset = 1.5, \n  group.colours = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  background.circle.colour = \"cornflowerblue\",\n  background.circle.transparency = 0.15,\n  gridline.mid.colour = \"cornflowerblue\",\n  legend.position = \"bottom\", \n  base.size = 4, \n  plot.title = \"Gram stain positive\"\n  ) +\n  geom_point(aes(x = 0, y = 0), \n             alpha = 0.04, \n             size = 49, \n             color = \"cornflowerblue\") +\n  geom_text(mapping = aes(x = 0, y = -2.4, label = c(\"max dose\")),\n            vjust = 0, \n            hjust = 0.5, \n            color = \"gray30\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nx <- dt[Gram_staining == \"Stain-negative\", .(Bacteria, Antibiotic, log10_conc)]\nx <- dcast(x, Antibiotic ~ Bacteria)\nsetcolorder(x, c(1, 3, 8, 9, 4, 6, 5, 7, 2, 10))\n\nggradar(\n  x, \n  values.radar = c(-3, -1, 3),\n  grid.min = -3, \n  grid.mid = -1, \n  grid.max =  3,\n  centre.y = -4, \n  plot.extent.x.sf = 1.25, \n  plot.extent.y.sf = 1.25, \n  group.line.width = 1, \n  group.point.size = 3,\n  gridline.label.offset = 0, \n  group.colours = c(\"#00AFBB\", \"#E7B800\", \"#FC4E07\"),\n  background.circle.colour = \"pink\",\n  background.circle.transparency = 0.15,\n  gridline.mid.colour = \"pink\",\n  legend.position = \"bottom\", \n  base.size = 4, \n  plot.title = \"Gram stain negative\"\n  ) +\n  geom_point(aes(x = 0, y = 0), \n             alpha = 0.04, \n             size = 49, \n             color = \"pink\") +\n  geom_text(mapping = aes(x = 0, y = -2.4, label = c(\"max dose\")),\n            vjust = 0, \n            hjust = 0.5, \n            color = \"gray30\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#| fig-asp: 0.6\nggplot(dt, aes(x = log10_conc, \n               y = reorder(Bacteria, row_order))) +\n  facet_grid(rows = vars(Gram_staining), \n             cols = vars(Antibiotic), \n             as.table = FALSE, \n             scales = \"free_y\",\n             space = \"free_y\") +\n  labs(x = \"Concentration (mg/dl)\", \n       y = \"\", \n       title = \"Antibiotic concentration required to halt in-vitro growth\") +\n  scale_x_continuous(limits = c(-3.5, 3.5), \n                     breaks = seq(-3, 3, 2), \n                     labels = function(x){paste0(\"10^\", x)}) +\n  geom_rect(aes(xmin = -Inf,\n                xmax = -1,\n                ymin = -Inf,\n                ymax = Inf), \n            color = \"transparent\", \n            fill = dt$panel_fill, \n            alpha = 0.05) +\n  geom_rect(aes(xmin = -1,\n                xmax = Inf,\n                ymin = -Inf,\n                ymax = Inf), \n            color = \"transparent\", \n            fill = dt$panel_fill, \n            alpha = 0.01) +\n  geom_vline(xintercept = -1, linetype = 2) +\n  geom_point(size = 2) +\n  geom_point(data = dt[log10_conc > -1], size = 2, color = \"gray70\") +\n  geom_text(data = dt[Gram_staining == \"Stain-negative\"], \n            mapping = aes(x = -1, y = 1, label = c(\"max dose\")),\n            vjust = -0.3, \n            hjust = 0, \n            angle = 90, \n            color = \"gray30\") +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        axis.text.x = element_markdown(), \n        strip.text = element_text(size = 11))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n### Additional software credits {.appendix}\n  \n- [`fmsb`](https://github.com/JLSteenwyk/ggpubfigs) for radar charts\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}