{
  "hash": "7cddb446aa70d89dc69e0dc8a7f88e7f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Spiders, facets, and dots, oh my!\"\ndescription: |\n  A case study comparing the effectiveness of a radar chart to a faceted dot chart. \ndate: \"2022-08-21\"\ndate-format: \"YYYY-MM-DD\"\ncategories: [R, ggplot2, data storytelling, magick, chart design]\nimage: \"thumbnail.png\"\ncap-location: margin\ndraft: false\n---\n\n\n\n\n\n:::{.callout-note}\n## Summary \n<em>I compare the effectiveness of two charts---a radar (or spider) chart and a faceted dot chart---in communicating information about Burtin's 1951 antibiotics/bacteria data. The faceted dot chart is more effective, suggesting in general that radar charts should be replaced by dot-chart designs configured for the data at hand.</em>\n:::\n\nAt a recent virtual workshop, a participant asked my opinion of radar charts (also called spider charts). I replied that I think there are nearly always more effective alternatives.\n\nOther authors agree, e.g., Graham Odds [-@Odds:2011] and Stephen Few [-@Few:2005], concluding that bar charts or line charts communicate information more effectively than radar charts in nearly every case. I concur, but I thought it would be interesting to compare a radar chart to an alternative using somewhat more complex data than those in typical examples. \n\nI selected data from a 1951 chart by graphic designer Will Burtin (1908--1972) displaying the effectiveness of three antibiotics in inhibiting the growth of 16 bacteria. My inspiration is *Medical Illuminations* [-@Wainer:2014] in which Howard Wainer discusses in detail twenty different charts of these data. In this post, I compare two new displays of these data---a radar chart and a faceted dot chart. \n\nFor reproducibility, the R code for the post is listed under the “R code” pointers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# packages used \nlibrary(\"data.table\")\nlibrary(\"ggplot2\")\nlibrary(\"ggradar\") # ggplot2 compatible radar charts\n```\n:::\n\n\nFor consistent radar charts, I wrap `ggradar()` in a custom function. I selected the ggradar package because it supports editing using conventional ggplot2 functions.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# custom function for consistent radar charts\nmake_radar_chart <- function(dframe, subtitle) {\n  \n  # assign constants\n  tick <- 0.3\n  grid_lines <- c(-3, -1, 3)\n  medium_gray <- \"gray70\"\n  \n  # delete all but the required columns\n  dframe <- dframe[, .(Bacteria, Penicillin, Streptomycin, Neomycin)]\n\n  # create the radar chart using a subset of the data frame  \n  ggradar(plot.data = dframe, \n          \n          # three grid lines allowed\n          values.radar = grid_lines, \n          grid.min = grid_lines[1], \n          grid.mid = grid_lines[2], \n          grid.max = grid_lines[3],\n          \n          # manual adjustments for clear viewing\n          gridline.label.offset = 1.5, \n          plot.extent.x.sf = 1.5, \n          plot.extent.y.sf = 1.25,\n          centre.y = -4,\n          \n          # aesthetics\n          background.circle.colour = \"transparent\",\n          grid.label.size = 5, \n          group.line.width = 0.5, \n          group.point.size = 3) +\n    \n    # ggplot2 edits, including tick marks along the P-axis\n    labs(subtitle = subtitle) +\n    theme(plot.subtitle = element_text(size = 18, \n                                       face = \"bold\", \n                                       hjust = 0, \n                                       vjust = -4, \n                                       color = medium_gray), \n          legend.justification = c(0, 1), \n          legend.background = element_blank(), \n          legend.key.height = unit(6, \"mm\"), \n          legend.position = c(-0.04, 0.93), # c(-0.04, 1.05), \n          legend.text  = element_text(size = 12, face = \"italic\"), \n          legend.title = element_blank()) +\n    geom_segment(x = -tick, y = 2, xend = tick, yend = 2, color = medium_gray) +\n    geom_segment(x = -tick, y = 4, xend = tick, yend = 4, color = medium_gray) +\n    geom_segment(x = -tick, y = 5, xend = tick, yend = 5, color = medium_gray) +\n    geom_segment(x = -tick, y = 6, xend = tick, yend = 6, color = medium_gray) \n}\n```\n:::\n\n\n\n\n\n\n\n\n\n\n\n\n\n## Data\n\nI transcribed the data from Wainer (Table 2.1, p. 24) but updated the taxonomy  of two bacteria that have been renamed since Burtin's work. \n\n::: {.column-margin}\nIn 1974, *Diplococcus pneumoniae* was renamed *Streptococcus pneumoniae*. In 1984, *Streptococcus faecalis*  was renamed *Enterococcus faecalis*.  \n:::\n\nOne of Wainer's goals was to illustrate how some chart designs, had they been investigated sooner, could have revealed an odd pattern in Burtin's data that might have led to an earlier reclassification of bacterium genus. My goal is different. I want to illustrate the relative effectiveness of two specific charts by considering the ease and accuracy of answering key domain-specific questions about the data.\n\nThe data with current taxonomy are saved in the blog data directory as a [CSV file](https://raw.githubusercontent.com/graphdr/data-stories/main/data/antibiotic-bacteria-mic.csv).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read the updated Burtin data set\nDT <- fread(\"data/antibiotic-bacteria-mic.csv\")\n\n# examine the data\nDT[]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Bacteria Gram_stain Penicillin Streptomycin Neomycin\n                       <char>     <char>      <num>        <num>    <num>\n 1:      Aerobacter aerogenes   negative    8.7e+02         1.00    1.600\n 2:        Bacillus anthracis   positive    1.0e-03         0.01    0.007\n 3:          Brucella abortus   negative    1.0e+00         2.00    0.020\n 4:  Streptococcus pneumoniae   positive    5.0e-04        11.00   10.000\n 5:          Escherichia coli   negative    1.0e+02         0.40    0.100\n---                                                                      \n12:      Staphylococcus albus   positive    7.0e-03         0.10    0.001\n13:     Staphylococcus aureus   positive    3.0e-02         0.03    0.001\n14:     Enterococcus faecalis   positive    1.0e+00         1.00    0.100\n15: Streptococcus hemolyticus   positive    1.0e-03        14.00   10.000\n16:    Streptococcus viridans   positive    5.0e-03        10.00   40.000\n```\n\n\n:::\n:::\n\n\nThe data set comprises three categorical variables and one quantitative variable as listed in @tbl-data-structure. The quantitative variable is the *minimum inhibitory concentration* (MIC)---the least concentration of antibiotic that prevents growth of a bacterium in vitro, where *concentration* is the ratio of the drug to its  liquid media in milligrams/deciliter (mg/dl). \n\n\n::: {#tbl-data-structure .cell tbl-cap='Data structure'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> variable </th>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> structure </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> bacteria </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, nominal, 16 levels </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> antibiotic </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, nominal, 3 levels </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> min. inhibitory concentration (MIC) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> quantitative (mg/dl) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Gram stain </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, 2 levels, dependent on bacteria </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nThe *Gram stain* variable indicates a bacterium's response to a cell-staining method, named after bacteriologist Hans Christian Gram (1853--1938). After staining and counter-staining, those that remain purple are called Gram-positive; those that turn pink are called Gram-negative. \n\n\n\n\n\n\n## Shaping the data\n\nI'm not using Gram staining as a graph element, so I append the Gram-positive information to the name of the bacterium and drop the Gram-staining variable. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# append Gram-positive to bacteria names\nDT[Gram_stain == \"positive\", Bacteria := paste(Bacteria, \"(+)\")]\nDT[, Gram_stain := NULL]\n\n# display the result\nDT[]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                         Bacteria Penicillin Streptomycin Neomycin\n                           <char>      <num>        <num>    <num>\n 1:          Aerobacter aerogenes    8.7e+02         1.00    1.600\n 2:        Bacillus anthracis (+)    1.0e-03         0.01    0.007\n 3:              Brucella abortus    1.0e+00         2.00    0.020\n 4:  Streptococcus pneumoniae (+)    5.0e-04        11.00   10.000\n 5:              Escherichia coli    1.0e+02         0.40    0.100\n---                                                               \n12:      Staphylococcus albus (+)    7.0e-03         0.10    0.001\n13:     Staphylococcus aureus (+)    3.0e-02         0.03    0.001\n14:     Enterococcus faecalis (+)    1.0e+00         1.00    0.100\n15: Streptococcus hemolyticus (+)    1.0e-03        14.00   10.000\n16:    Streptococcus viridans (+)    5.0e-03        10.00   40.000\n```\n\n\n:::\n:::\n\n\nI order the bacteria by the median of their three MIC values (per Wainer)\nand add a lowercase letter (a.--p.) to the bacteria names to provide a simple verification that the charts reflect the desired order. \n\nBecause MIC values span several orders of magnitude, I also apply a log~10~ transformation to the numerical columns. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# order bacteria by row-wise median MIC\nDT[, median_MIC := apply(.SD, 1, median), .SDcols = c(\"Penicillin\", \"Streptomycin\", \"Neomycin\")]\nsetorder(DT, median_MIC)\n\n# lowercase letters to verify bacteria order in the charts\nDT[, order_ID := letters[1:nrow(DT)]]\nDT[, Bacteria := paste0(order_ID, \". \", Bacteria)]\nDT[, order_ID := NULL]\n\n# transform MIC by log10\nnumeric_cols <- which(sapply(DT, is.numeric))\nDT[ , (numeric_cols) := lapply(.SD, log10), .SDcols = numeric_cols]\n\n# display the result\nDT[]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            Bacteria Penicillin Streptomycin Neomycin\n                              <char>      <num>        <num>    <num>\n 1:        a. Bacillus anthracis (+)     -3.000       -2.000   -2.155\n 2:      b. Staphylococcus albus (+)     -2.155       -1.000   -3.000\n 3:     c. Staphylococcus aureus (+)     -1.523       -1.523   -3.000\n 4:              d. Proteus vulgaris      0.477       -1.000   -1.000\n 5:              e. Escherichia coli      2.000       -0.398   -1.000\n---                                                                  \n12:        l. Pseudomonas aeruginosa      2.929        0.301   -0.398\n13:    m. Mycobacterium tuberculosis      2.903        0.699    0.301\n14:  n. Streptococcus pneumoniae (+)     -3.301        1.041    1.000\n15: o. Streptococcus hemolyticus (+)     -3.000        1.146    1.000\n16:    p. Streptococcus viridans (+)     -2.301        1.000    1.602\n    median_MIC\n         <num>\n 1:     -2.155\n 2:     -2.155\n 3:     -1.523\n 4:     -1.000\n 5:     -0.398\n---           \n12:      0.301\n13:      0.699\n14:      1.000\n15:      1.000\n16:      1.000\n```\n\n\n:::\n:::\n\n\nClinically plausible dosages are those less than 0.1 mg/dl or log~10~MIC &#8804; --1. Thus concentrations greater than --1 indicate a bacterium that for clinical purposes can be considered *resistant* to the antibiotic. \n\nWainer illustrates (in Figure 3.3 by Brian Schmotzer, p. 54) that this resistance measure, summarized in @tbl-resistance-groupings, is a useful criterion by which the data in a chart can be organized to answer key questions. \n\n\n::: {#tbl-resistance-groupings .cell tbl-cap='Bacterial resistance groupings'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> Label </th>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> Bacterium is resistant to </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> None </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> None of the three antibiotics </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> P </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Penicillin only </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> PS </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Penicillin and Streptomycin only </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> SN </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Streptomycin and Nemomycin only </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> PSN </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> All three antibiotics </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nI add these resistance labels to the data frame, creating a new categorical variable (`resistance`) that is dependent on the bacteria. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# classify bacteria by resistance\nDT[, resistance := fcase(\n  Penicillin >  -1 & Streptomycin >  -1 & Neomycin >  -1, \"PSN\", \n  Penicillin >  -1 & Streptomycin >  -1 & Neomycin <= -1, \"PS\", \n  Penicillin <= -1 & Streptomycin >  -1 & Neomycin >  -1, \"SN\", \n  Penicillin >  -1 & Streptomycin <= -1 & Neomycin <= -1, \"P\", \n  Penicillin <= -1 & Streptomycin <= -1 & Neomycin <= -1, \"None\" \n)]\n\n# display the result\nDT[]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            Bacteria Penicillin Streptomycin Neomycin\n                              <char>      <num>        <num>    <num>\n 1:        a. Bacillus anthracis (+)     -3.000       -2.000   -2.155\n 2:      b. Staphylococcus albus (+)     -2.155       -1.000   -3.000\n 3:     c. Staphylococcus aureus (+)     -1.523       -1.523   -3.000\n 4:              d. Proteus vulgaris      0.477       -1.000   -1.000\n 5:              e. Escherichia coli      2.000       -0.398   -1.000\n---                                                                  \n12:        l. Pseudomonas aeruginosa      2.929        0.301   -0.398\n13:    m. Mycobacterium tuberculosis      2.903        0.699    0.301\n14:  n. Streptococcus pneumoniae (+)     -3.301        1.041    1.000\n15: o. Streptococcus hemolyticus (+)     -3.000        1.146    1.000\n16:    p. Streptococcus viridans (+)     -2.301        1.000    1.602\n    median_MIC resistance\n         <num>     <char>\n 1:     -2.155       None\n 2:     -2.155       None\n 3:     -1.523       None\n 4:     -1.000          P\n 5:     -0.398         PS\n---                      \n12:      0.301        PSN\n13:      0.699        PSN\n14:      1.000         SN\n15:      1.000         SN\n16:      1.000         SN\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n## Radar charts\n\nThis data frame is correctly shaped for `ggradar()` in *row-record* form, in which every record about a bacterium is in a single row.  \n\n**Explaining a radar chart**\n\nI subset one bacterium (one row and four columns) from the data frame to illustrate radar-chart terminology in @fig-radar-components.   \n\n\n::: {.cell layout=\"[[85,-15]]\"}\n\n```{.r .cell-code}\n# select one row only from the data set \ndata_group <- DT[Bacteria %ilike% \"abortus\", .(Bacteria, Penicillin, Streptomycin, Neomycin)]\n\n# display the result\ndata_group[]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              Bacteria Penicillin Streptomycin Neomycin\n                <char>      <num>        <num>    <num>\n1: h. Brucella abortus          0        0.301     -1.7\n```\n\n\n:::\n\n```{.r .cell-code}\n# create the sample radar chart\np <- make_radar_chart(data_group, subtitle = \"Radar chart components\") \n\n# annotate the features of the chart\np +\n  geom_text(x = 2.5, y = 2.5, label = \"dosage max grid line\", \n            hjust = 0, vjust = 1, size = 4, color = \"gray45\") +\n  geom_text(x = -0.1, y = 5.7, label = \"P-axis\", \n            hjust = 1.1, size = 4, color = \"gray45\") +\n  geom_text(x = -4, y = -3.1, label = \"N-axis\", \n            hjust = 0.3, size = 4, color = \"gray45\") +\n  geom_text(x = 4.1, y = -3.1, label = \"S-axis\", \n            hjust = 0.7, size = 4, color = \"gray45\") +\n  geom_text(x = 5.5, y = 5.5, label = \"scale max grid line\", \n            hjust = 0, vjust = 1, size = 4, color = \"gray45\") +\n  geom_text(x = 5, y = -1.6, label = expression(\"log\"[10]~\"MIC\"), \n            hjust = 0.2, vjust = 0.8, size = 4, color = \"gray45\") \n```\n\n::: {.cell-output-display}\n![Illustrating the components of a radar chart with the log~10~MIC values of three antibiotics on one bacterium.](index_files/figure-html/fig-radar-components-1.png){#fig-radar-components width=672}\n:::\n:::\n\n\nThe axes of the chart encode the antibiotics: a P-axis (Penicillin), an S-axis (Streptomycin), and an N-axis (Neomycin). The three radial axes are rotated 120 degrees apart. \n\nThe axes have identical scales marked with log~10~MIC equal to --3, --1, and +3 and connected with circular grid lines.  Reference tick marks are added to the P-axis in integer increments. \n\nThe log~10~ concentration values are encoded as data markers *on the axes*---in this example, 0.0 on the P-axis, +0.3 on the S-axis, and --1.7 on the N-axis.  \n\nData markers inside the --1 grid line indicate clinically plausible MICs; points outside the line indicate resistance to the antibiotic. In this example, *Brucella abortus* is resistant to Penicillin and Streptomycin but not to Neomycin. \n\nThe thin helper lines between data markers create a polygon for that bacterium to help distinguish it from other bacteria when more than one are graphed in the same chart. The polygons, while useful visual aids, are not generally useful for drawing inferences about the data. \n\n\n\n\n\n**Creating the radar charts**\n\nI use the `resistance` variable to subset the data frame and construct one radar chart per group, yielding the five charts assembled in @fig-five-radar. The legend keys verify that the charts retain the desired order of the bacteria, from (a) to (p) in order of increasing median MIC.  \n\n\n::: {.cell layout=\"[[85,-15],[85,-15],[85,-15],[85,-15]]\"}\n\n```{.r .cell-code}\ndata_group <- DT[resistance == \"None\"]\nmake_radar_chart(data_group, subtitle = \"Resistant to None\")\n\ndata_group <- DT[resistance == \"P\"]\nmake_radar_chart(data_group, subtitle = \"Resistant to P\")\n\ndata_group <- DT[resistance == \"PS\"]\nmake_radar_chart(data_group, subtitle = \"Resistant to PS\")\n\ndata_group <- DT[resistance == \"PSN\"]\nmake_radar_chart(data_group, subtitle = \"Resistant to PSN\")\n\ndata_group <- DT[resistance == \"SN\"]\nmake_radar_chart(data_group, subtitle = \"Resistant to SN\")\n```\n:::\n\n\n![Radar charts of Burtin’s data with current bacteria taxonomy. Data points on the radial axes are log~10~MIC values.](figures/five_radar.png){#fig-five-radar}\n\nI assembled these images in a two-column format to make it possible to view all of them together. I made the font size as large as possible without overprinting important graphical elements. (The code for  assembling the images is provided in an appendix.) \n\n\n\n\n\n## Faceted dot chart\n\n**Shaping the data**\n\nFor compatibility with `ggplot()`, I transform the data from row records to *block records*. In block-record form, everything about a bacterium occupies a \"block\" of rows. For example, *Bacillus anthracis* occupies the first three rows instead of the first row alone as it did previously.  The utility of this form is that both `Antibiotic` and `Concentration` are explicit variables with one value per observation (row). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nDT_facet <- melt(DT, \n           id.vars = c(\"Bacteria\", \"median_MIC\", \"resistance\"), \n           variable.name = \"Antibiotic\", \n           variable.factor = FALSE, \n           value.name = \"Concentration\")\nsetcolorder(DT_facet, c(\"Bacteria\", \"Antibiotic\", \"Concentration\",  \"median_MIC\", \"resistance\"))\n\n# order rows to illustrate block records\nDT_facet[order(median_MIC, Bacteria)]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                            Bacteria   Antibiotic Concentration median_MIC\n                              <char>       <char>         <num>      <num>\n 1:        a. Bacillus anthracis (+)   Penicillin         -3.00      -2.15\n 2:        a. Bacillus anthracis (+) Streptomycin         -2.00      -2.15\n 3:        a. Bacillus anthracis (+)     Neomycin         -2.15      -2.15\n 4:      b. Staphylococcus albus (+)   Penicillin         -2.15      -2.15\n 5:      b. Staphylococcus albus (+) Streptomycin         -1.00      -2.15\n---                                                                       \n44: o. Streptococcus hemolyticus (+) Streptomycin          1.15       1.00\n45: o. Streptococcus hemolyticus (+)     Neomycin          1.00       1.00\n46:    p. Streptococcus viridans (+)   Penicillin         -2.30       1.00\n47:    p. Streptococcus viridans (+) Streptomycin          1.00       1.00\n48:    p. Streptococcus viridans (+)     Neomycin          1.60       1.00\n    resistance\n        <char>\n 1:       None\n 2:       None\n 3:       None\n 4:       None\n 5:       None\n---           \n44:         SN\n45:         SN\n46:         SN\n47:         SN\n48:         SN\n```\n\n\n:::\n:::\n\n\nWe can add one more categorical variable (`efficacy`) to help visually distinguish between clinically plausible dosages (log~10~MIC ≤ --1) and bacterial resistance (log~10~MIC > -1) in the faceted dot chart. @tbl-data-structure-2 lists the complete augmented set of variables.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# efficacy variable used as legend key\nDT_facet[, efficacy := fifelse(Concentration <= -1, \"Effective\", \"Resistant\")]\n```\n:::\n\n::: {#tbl-data-structure-2 .cell tbl-cap='Augmented data structure'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n  <tr>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> variable </th>\n   <th style=\"text-align:left;background-color: rgba(199, 234, 229, 255) !important;\"> structure </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> bacteria </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, nominal, 16 levels </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> antibiotic </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, nominal, 3 levels </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> min. inhibitory concentration (MIC) </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> quantitative (mg/dl) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> Gram stain </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, 2 levels, dependent on bacteria </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> resistance profile </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, 5 levels, dependent on bacteria </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> efficacy </td>\n   <td style=\"text-align:left;color: black !important;background-color: white !important;\"> categorical, 2 levels, dependent on MIC </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n\n\n**Creating the faceted dot chart**\n\nBefore plotting, I edit the data to order the rows and panels and add a resistance subtitle.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# manually order the columns of the panel grid\nDT_facet[, Antibiotic := lapply(.SD, factor, levels = c(\"Penicillin\", \"Streptomycin\", \"Neomycin\")), .SDcols = \"Antibiotic\"]\n\n# order the bacteria as a factor\nDT_facet[, Bacteria := lapply(.SD, factor, levels = rev(sort(unique(Bacteria)))), .SDcols = \"Bacteria\"]\n\n# add a subtitle for the resistance category \nDT_facet[resistance == \"None\", resistance := \"Resistant\\nto\\nNone\"]\n```\n:::\n\n\nThe resulting chart has 15 facets in a 5 by 3 grid---five rows for the resistance variable and three columns for the antibiotic variable. Individual bacteria form an ordered vertical scale. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# construct the faceted dot chart\nggplot(DT_facet, aes(x = Concentration, y = Bacteria, color = efficacy)) +\n  geom_point(size = 2) +\n  facet_grid(cols = vars(Antibiotic),\n             rows = vars(reorder(resistance, median_MIC)), \n             switch = \"y\", \n             scales = \"free_y\",\n             space  = \"free_y\") +\n  \n  # annotations\n  geom_vline(xintercept = -1, linetype = 2, linewidth = 0.5, color = \"gray40\") +\n  geom_text(data  = DT_facet[resistance == \"PSN\"], \n            mapping = aes(x = -1, y = 1.5, label = c(\"max dose\")),\n            vjust = -0.4, hjust = 0, angle = 90, color = \"gray30\", size = 3) +\n  \n  # scales\n  scale_x_continuous(limits = c(-3.5, 3.5), breaks = seq(-3, 3, 2)) +\n  scale_color_manual(values = c(\"black\", \"gray\")) +\n  scale_y_discrete(position = \"right\") + \n  labs(x = \"MIC (log10 mg/dl)\", y = \"\") +\n  \n  # theme arguments\n  theme_minimal() +\n  theme(\n    # MIC scale\n    axis.text.x   = element_text(size = 9),\n    # bacteria scale\n    axis.text.y   = element_text(size = 9, hjust = 0, angle = 0, face = \"italic\"), \n    # antibiotic labels\n    strip.text.x  = element_text(size = 10, hjust = 0),\n    # resistance labels\n    strip.text.y.left  = element_text(size = 10, hjust = 1, angle = 0), \n    # panels\n    panel.border  = element_rect(fill = NA, color = \"gray90\", linewidth = 0.7),\n    panel.spacing = unit(1, \"mm\"), \n    # legend\n    legend.position = \"bottom\", \n    legend.title = element_blank(), \n    legend.text  = element_text(size = 12), \n    legend.key.size = unit(2, \"mm\")\n  )\n```\n\n::: {.cell-output-display}\n![Faceted dot chart of Burtin's data with current bacteria taxonomy. Bacteria are ordered (a) through (p) by increasing median MIC.](index_files/figure-html/fig-faceted-1.png){#fig-faceted width=672}\n:::\n:::\n\n\nThe log~10~MIC variable is encoded on identical horizontal scales.  The maximum clinically plausible dosage is indicated with a vertical dashed line, separating interactions that are effective from those that are resistant.\n\nFor ggplot2 users, the interesting features of the code include: \n\n- `facet_grid(switch = \"y\")` with `scale_y_discrete(position = \"right\")` to place the bacteria labels on the right and the resistance category on the left\n- `facet_grid()` arguments `scales` and `space` to create evenly spaced rows  when, because of dependent categories, no facets are small multiples. \n\n\n\n\n## Discussion\n\nWainer poses five possible key questions that the data were gathered to answer (p. 30). Two of those questions arise naturally from the basic data structure---that MIC observations correspond to unique antibiotic-bacterium combinations. The first question focuses on the *bacteria:* \n\n1. How do the bacteria group vis-&#224;-vis their reaction to the antibiotics?\n\nAs we have seen, grouping bacteria by their resistance profiles succeeds in revealing similarities. Both the radar chart and the faceted dot chart support this grouping *visually:* in the radar chart, by the similarity of polygons in an individual sub-plot; in the faceted chart, by the similarity of dot patterns in an individual facet. \n\nThe second question focuses on the *antibiotics:* \n\n2. How do the antibiotics group with respect to their efficacy in controlling the bacteria? \n\nConsider first the efficacy of the drugs on one bacterium, e.g., item (g), *Salmonella schottmeulleri*.  From the radar chart, we can infer that Neomycin is effective and that the other two drugs are resistant. However, the overprinting of data markers on the three axes makes it difficult to visually quantify the differences between the P-, S-, and N-value of MIC for this bacterium. \n\nIn contrast, in the faceted dot chart, data markers for a bacterium are located in a  row with one row per bacterium and one panel per antibiotic. There is no overprinting. Looking along row (g), we again see that Neomycin is effective and the others are resistant but we can also  visually estimate the MIC values using the horizontal scale: Neomycin log~10~MIC &#8776; --1, Streptomycin &#8776; 0, and Penicillin &#8776; 1. \n\nThe faceted chart, compared to the radar chart, makes such differences easier to quantify. Adding more circular grid lines to the radar chart might improve our ability to estimate its MIC values, but the radar chart has an intrinsic  potential for data markers (and the polygons) overprinting one another. \n\nSecond, let's consider differential efficacy of the drugs across groupings. For example, for how many of the resistance-groupings is penicillin effective? Using the radar charts, we examine the P-axis of all 5 charts and conclude that Penicillin is effective in two of the groupings. (The names of the groupings tell us this as well, but here I want to focus on the effectiveness of the visualization.)\n\nIn the faceted chart, the five panels in the Penicillin column yield the same conclusion *at a glance.* \n\n Wainer's other three questions are: \n\n3. What bacterium does this antibiotic kill?\n4. What antibiotic kills this bacterium?\n5. Does the \"Gram staining\" variable help us make decisions regarding which antibiotic to use? \n\nAll three questions can be answered by both charts, but generally more quickly and clearly using the faceted dot chart. I leave the details of that comparison to the reader. \n\nIn general, the advantages of the faceted dot chart include:\n \n- Horizontal grid lines suffice to distinguish one bacterium from another. \n- Greater visual access to patterns of data in different combinations.\n- Relatively compact without sacrificing readability.\n- Data markers do not overprint one another.\n- Conventional horizontal scales.\n\n\n\n## Conclusion\n\nUsing Will Burtin's 1951 data on the efficacy of three antibiotics on 16 bacteria (with updated bacteria taxonomy), I compared the effectiveness of two types of charts by considering the ease and accuracy of answering key domain-specific questions. \n\nBy using the same data organized in the same way, both charts are designed to convey the same message. Thus any differences in perceived effectiveness should be due to differences in chart structure, that is, characteristics of the chart intrinsic to its type.  \n\nFor the data at hand, a faceted dot chart communicates more effectively than a radar chart. Intrinsic differences between the two chart types suggest that in general appropriately configured dot charts are more effective than radar  charts. \n\n\n\n### Additional software credits {.appendix}\n  \n- [`ggradar`](https://github.com/ricardo-bion/ggradar) for radar charts\n- [`magick`](https://cran.r-project.org/package=magick) for image processing\n\n### Image processing with magick {.appendix}\n\nThe following code chunk is provided for readers interested in the image processing I used to assemble the five radar charts into one figure. As usual in R, there are several ways to approach this task; here I use \"magick,\" an R package for advanced graphics and image processing. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# image processing using the magick package\nlibrary(magick)\n\n# custom functions\ntrim_radar <- function(data_group, subtitle, img_path, name_png) {\n  p <- make_radar_chart(data_group, subtitle)\n  ggsave_radar(p, img_path, name_png)\n  img <- image_read(paste0(img_path, name_png))\n  img <- image_trim(img)\n}\nggsave_radar <- function(p, img_path, name_png) {\n  ggsave(\n    plot = p,\n    path = img_path, \n    filename = name_png,\n    width = 6.8, \n    height = 5, \n    units = \"in\"\n  )\n}\n\n# local path to figures\nimg_path <- \"posts/2022-08-15-radar-charts/figures/\"\n\n# create individual radar charts\nimg1 <- trim_radar(data_group = DT[resistance == \"None\"], \n           subtitle = \"Resistant to None\", \n           img_path = img_path, \n           name_png = \"none.png\")\nimg2 <- trim_radar(data_group = DT[resistance == \"P\"], \n           subtitle = \"Resistant to P\", \n           img_path = img_path, \n           name_png = \"p.png\")\nimg3 <- trim_radar(data_group = DT[resistance == \"PS\"], \n           subtitle = \"Resistant to PS\", \n           img_path = img_path, \n           name_png = \"ps.png\")\nimg4 <- trim_radar(data_group = DT[resistance == \"PSN\"], \n           subtitle = \"Resistant to PSN\", \n           img_path = img_path, \n           name_png = \"psn.png\")\nimg5 <- trim_radar(data_group = DT[resistance == \"SN\"], \n           subtitle = \"Resistant to SN\", \n           img_path = img_path, \n           name_png = \"sn.png\")\n\n# white box same width as figure to vertically offset second column\nw <- image_info(img1)[[\"width\"]]\nh <- image_info(img1)[[\"height\"]]\nbox <- image_blank(width = w, height = h * 0.5, color = \"white\")\n\n# thin vertical separation strip\nwhite_strip <- image_blank(width = 30, height = h, color = \"white\")\ngray_strip  <- image_blank(width = 5, height = h, color = \"gray70\")\n\n# assemble composite figure\nimg1 <- image_append(c(img1, white_strip, gray_strip, white_strip), stack = FALSE)\nimg2 <- image_append(c(img2, white_strip, gray_strip, white_strip), stack = FALSE)\nimg3 <- image_append(c(img3, white_strip, gray_strip, white_strip), stack = FALSE)\ncol_1 <- image_append(c(img1, img2, img3), stack = TRUE)\ncol_2 <- image_append(c(box, img4, img5), stack = TRUE)\nimg   <- image_append(c(col_1, col_2), stack = FALSE)\n\n# write final image to file\nimage_write(img, path = paste0(img_path, \"five_radar.png\"))\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}